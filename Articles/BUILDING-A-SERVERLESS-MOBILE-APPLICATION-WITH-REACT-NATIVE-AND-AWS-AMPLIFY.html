<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>BUILDING A SERVERLESS MOBILE APPLICATION WITH REACT NATIVE AND AWS AMPLIFY</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">BUILDING A SERVERLESS MOBILE APPLICATION WITH REACT NATIVE AND AWS AMPLIFY</h1>
</header>
<section data-field="subtitle" class="p-summary">
Introduction
</section>
<section data-field="body" class="e-content">
<section name="2811" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="baec" id="baec" class="graf graf--h3 graf--leading graf--title">Building a Serverless Mobile Application With React Native And Aws Amplify</h3><figure name="50fc" id="50fc" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 368px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 52.5%;"></div><img class="graf-image" data-image-id="0*Co1hHl-_kNLv2K1I.jpg" data-width="800" data-height="420" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*Co1hHl-_kNLv2K1I.jpg"></div></figure><h3 name="2717" id="2717" class="graf graf--h3 graf-after--figure">Introduction</h3><p name="9405" id="9405" class="graf graf--p graf-after--h3"><a href="https://aws-amplify.github.io/" data-href="https://aws-amplify.github.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">AWS Amplify</a> is a command line tool-chain that helps you to develop and connect AWS cloud services directly to any frontend environment, whether a library such as ReactJS or a mobile development framework, React Native. Building a full-stack mobile app in the real world requires a lot of basic requirements to be fulfilled. AWS Amplify tries to reduce the amount of time spent on building an application using it.</p><p name="220f" id="220f" class="graf graf--p graf-after--p">This tutorial is a step-by-step guide to connect AWS Amplify and AWS AppSync services with your React Native application. You are also going to use Expo CLI to scaffold a React Native app quickly.</p><h3 name="de0f" id="de0f" class="graf graf--h3 graf-after--p">Prerequisites</h3><p name="3094" id="3094" class="graf graf--p graf-after--h3">You are going to need the following installed on your local dev machine in order to follow this tutorial.</p><ul class="postList"><li name="bddc" id="bddc" class="graf graf--li graf-after--p"><a href="https://nodejs.org/" data-href="https://nodejs.org/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Node.js/npm installed on your local machine</a> version &gt;= <code class="markup--code markup--li-code">10.x.x</code></li><li name="ec37" id="ec37" class="graf graf--li graf-after--li"><a href="https://facebook.github.io/watchman/" data-href="https://facebook.github.io/watchman/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">watchman</a> to watch file changes in a React Native app</li><li name="0c93" id="0c93" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">[expo-cli](https://www.npmjs.com/package/expo-cli)</code> version &gt;= <code class="markup--code markup--li-code">2.13.0</code></li><li name="b2ba" id="b2ba" class="graf graf--li graf-after--li"><a href="https://aws.amazon.com/console/" data-href="https://aws.amazon.com/console/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">AWS account</a></li><li name="f9b4" id="f9b4" class="graf graf--li graf-after--li"><a href="https://www.npmjs.com/package/@aws-amplify/cli" data-href="https://www.npmjs.com/package/@aws-amplify/cli" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">@aws-amplify/cli version</a> &gt;= <code class="markup--code markup--li-code">1.1.18</code></li></ul><p name="8a18" id="8a18" class="graf graf--p graf-after--li">You should have some familiarity with React Native and mobile development, and be able to troubleshoot your own dev environment.</p><blockquote name="1b2f" id="1b2f" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">Note: Working with development environments can be a bit tricky. Since, you are going to use Expo CLI for this tutorial.</em></blockquote><h3 name="e1b7" id="e1b7" class="graf graf--h3 graf-after--blockquote">What is AWS Amplify?</h3><p name="e40b" id="e40b" class="graf graf--p graf-after--h3">Amazon Web Services is a well-known technology that provides cloud services. These services include hosting, storage, database technologies and managing serverless applications for both mobile and web. React Native already has an advantage by quickly and easily bootstrapping an app using tools like Expo (previously known as create-react-native-app). However, writing and managing a backend service for your app can be challenging. To help us JavaScript developers the AWS mobile team is exclusively managing a project called AWS Amplify that helps to embed cloud services and provide an infrastructure with features in the form of APIs as follows:</p><ul class="postList"><li name="45e6" id="45e6" class="graf graf--li graf-after--p">Authentication</li><li name="cd3c" id="cd3c" class="graf graf--li graf-after--li">GraphQL Client through an API, in most uses cases, AWS AppSync with offline and real-time features</li><li name="09c9" id="09c9" class="graf graf--li graf-after--li">Push Notifications</li><li name="8e12" id="8e12" class="graf graf--li graf-after--li">Interactions in the form of conversational bots</li><li name="437d" id="437d" class="graf graf--li graf-after--li">Cloud Storage</li><li name="8c92" id="8c92" class="graf graf--li graf-after--li">Internationalization</li></ul><p name="7a5f" id="7a5f" class="graf graf--p graf-after--li">To install amplify CLI tool, run the following command.</p><pre name="9d9b" id="9d9b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">npm install -g @aws-amplify/cli</code></pre><h3 name="fa90" id="fa90" class="graf graf--h3 graf-after--pre">Creating the Expo app</h3><p name="a75e" id="a75e" class="graf graf--p graf-after--h3">To create a new Expo application, run the following command from a terminal window.</p><pre name="ae20" id="ae20" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">expo init tbrlist-amplify</code></pre><p name="52d5" id="52d5" class="graf graf--p graf-after--pre">The Expo command line interface will prompt a few questions regarding the template of the project to be generated and the name and which package manager (<em class="markup--em markup--p-em">npm/yarn?</em>) to use to install npm dependencies. On initializing the new project it will ask you follow questions. Choose the below:</p><ul class="postList"><li name="5eeb" id="5eeb" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Choose a template</strong>: expo-template-blank</li><li name="e006" id="e006" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Please enter a few initial configuration values</strong>: “name”: “trblist Amplify”</li></ul><p name="31a2" id="31a2" class="graf graf--p graf-after--li">Take a look below for the first two questions and use npm to install app dependencies.</p><figure name="7265" id="7265" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 569px; max-height: 191px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 33.6%;"></div><img class="graf-image" data-image-id="0*yg7u7fJtGSURdydo.png" data-width="569" data-height="191" src="https://cdn-images-1.medium.com/max/800/0*yg7u7fJtGSURdydo.png"></div></figure><p name="f242" id="f242" class="graf graf--p graf-after--figure">After scaffolding a new Expo project navigate inside the directory using <code class="markup--code markup--p-code">cd tbrlist-amplify</code>.</p><h3 name="2d8c" id="2d8c" class="graf graf--h3 graf-after--p">Configure AWS amplify app</h3><p name="4476" id="4476" class="graf graf--p graf-after--h3">To begin with configuration, it is important to have an AWS account signup. This will make it easier for you to follow the rest of the tutorial. After logging in your default browser into the AWS console, open up the command line window in the Expo app project’s root. Run the following command:</p><pre name="36f9" id="36f9" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">amplify configure</code></pre><p name="9cdc" id="9cdc" class="graf graf--p graf-after--pre">Press enter to continue and it will ask you to login to AWS console account with your login credentials by opening a new browser window. Once logged in, go back to terminal window and press enter to continue, again. The CLI tool will now prompt you with a different set of questions in order to set up a cloud service and create a user in the cloud. Follow closely.</p><ul class="postList"><li name="f85e" id="f85e" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Choose a region</strong>: us-east-2</li><li name="3586" id="3586" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Specify the username of the new IAM user</strong>: tbrlist-amplify</li></ul><p name="671a" id="671a" class="graf graf--p graf-after--li">On entering the username, press <strong class="markup--strong markup--p-strong">enter</strong> and it will open AWS console again in a browser window for you to add a user.</p><figure name="7fcd" id="7fcd" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 394px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><img class="graf-image" data-image-id="1*jU3Z0QCj3EaEFk1mPRlTrw.jpeg" data-width="1318" data-height="742" src="https://cdn-images-1.medium.com/max/800/1*jU3Z0QCj3EaEFk1mPRlTrw.jpeg"></div></figure><p name="f735" id="f735" class="graf graf--p graf-after--figure">Make sure in the above screen that <strong class="markup--strong markup--p-strong">Programmatic access</strong> is checked as shown. This allows you to add the user you are now creating to create resources in the form of different APIs and tools by providing you with an access key and secret key. Click on the button <strong class="markup--strong markup--p-strong">Next: Permissions</strong>.On the next page, you will see that policy has already been selected by default. This provides you the full access to AWS services by enabling your user to be as an administrator. Click <strong class="markup--strong markup--p-strong">Next: Tags</strong>. On the next page, leave it blank.</p><figure name="00b1" id="00b1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 486px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 69.39999999999999%;"></div><img class="graf-image" data-image-id="0*L2abqbAsHROb0waQ.png" data-width="1038" data-height="720" src="https://cdn-images-1.medium.com/max/800/0*L2abqbAsHROb0waQ.png"></div></figure><p name="66ee" id="66ee" class="graf graf--p graf-after--figure">Now, click <strong class="markup--strong markup--p-strong">Next: Review</strong>.</p><figure name="0f86" id="0f86" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 481px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.7%;"></div><img class="graf-image" data-image-id="0*y4iUzOLqIN8aLsmA.png" data-width="1053" data-height="723" src="https://cdn-images-1.medium.com/max/800/0*y4iUzOLqIN8aLsmA.png"></div></figure><p name="507e" id="507e" class="graf graf--p graf-after--figure">Everything is good, now click <strong class="markup--strong markup--p-strong">Create user</strong>.</p><figure name="4502" id="4502" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 488px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 69.69999999999999%;"></div><img class="graf-image" data-image-id="0*dARr3dAuyHxO8F8C.png" data-width="1049" data-height="731" src="https://cdn-images-1.medium.com/max/800/0*dARr3dAuyHxO8F8C.png"></div></figure><p name="bc5a" id="bc5a" class="graf graf--p graf-after--figure">You will get an <strong class="markup--strong markup--p-strong">Access key</strong> and a <strong class="markup--strong markup--p-strong">secret key</strong>. Copy them and please enter these keys on your terminal.</p><figure name="c4ae" id="c4ae" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 454px; max-height: 58px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.8%;"></div><img class="graf-image" data-image-id="0*vvMPm9jgJ3AJz5X-.png" data-width="454" data-height="58" src="https://cdn-images-1.medium.com/max/800/0*vvMPm9jgJ3AJz5X-.png"></div></figure><p name="8bda" id="8bda" class="graf graf--p graf-after--figure">For <strong class="markup--strong markup--p-strong">Profile Name</strong>, we are going to enter the project name to keep things simple for now.</p><figure name="97ab" id="97ab" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 565px; max-height: 67px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 11.899999999999999%;"></div><img class="graf-image" data-image-id="0*nmbKPEA1Ak1SIxoD.png" data-width="565" data-height="67" src="https://cdn-images-1.medium.com/max/800/0*nmbKPEA1Ak1SIxoD.png"></div></figure><p name="d504" id="d504" class="graf graf--p graf-after--figure">You will get a success message that the new user has been setup and the command line prompt will exit as you can see this from the above image. The configuration of the AWS Amplify user is complete.</p><h3 name="fa8b" id="fa8b" class="graf graf--h3 graf-after--p">Initializing AWS Amplify</h3><p name="4ae9" id="4ae9" class="graf graf--p graf-after--h3">In this section, you will be initializing the Expo app in order to make it work with the AWS cloud services. The first step in this process is to run the below command from a terminal window inside the app directory.</p><pre name="541e" id="541e" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">amplify init</code></pre><p name="3efb" id="3efb" class="graf graf--p graf-after--pre">This command will you ask another set of questions in order to setup amplify SDK inside the Expo project. In the below screen you will find these questions and the answers you need to select. Most of them are default as prompted by the CLI tool. Except for the name of the environment and the default editor, you can choose the settings as default.</p><p name="3b8b" id="3b8b" class="graf graf--p graf-after--p">For the <strong class="markup--strong markup--p-strong">name of the environment</strong> you can either choose the name of the operating system you are working on or the environments such as <code class="markup--code markup--p-code">dev</code>, <code class="markup--code markup--p-code">local</code> or <code class="markup--code markup--p-code">production</code>. To choose a default editor, you are prompter with different options such as <code class="markup--code markup--p-code">Visual Studio Code</code>.</p><figure name="1a61" id="1a61" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 566px; max-height: 233px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.199999999999996%;"></div><img class="graf-image" data-image-id="0*ZmJRX3ULMNTe5uMp.png" data-width="566" data-height="233" src="https://cdn-images-1.medium.com/max/800/0*ZmJRX3ULMNTe5uMp.png"></div></figure><p name="9a1f" id="9a1f" class="graf graf--p graf-after--figure">When asked if you would like to use an AWS profile, choose <strong class="markup--strong markup--p-strong">Yes</strong>, using the user profile you created when configuring the CLI earlier: <code class="markup--code markup--p-code">tbrlist-amplify</code>.</p><figure name="2899" id="2899" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 439px; max-height: 78px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 17.8%;"></div><img class="graf-image" data-image-id="0*3v7-nmaJJpgGm_pg.png" data-width="439" data-height="78" src="https://cdn-images-1.medium.com/max/800/0*3v7-nmaJJpgGm_pg.png"></div></figure><p name="ca07" id="ca07" class="graf graf--p graf-after--figure">After a few moments, it will create a new directory inside our Expo app called <code class="markup--code markup--p-code">amplify</code> that mostly contains configuration files. It will also edit <code class="markup--code markup--p-code">.gitignore</code> file so make sure you have that file at the root of your project.</p><figure name="77da" id="77da" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 384px; max-height: 261px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68%;"></div><img class="graf-image" data-image-id="0*3GHtxAztHr0FfGoV.png" data-width="384" data-height="261" src="https://cdn-images-1.medium.com/max/800/0*3GHtxAztHr0FfGoV.png"></div></figure><p name="2a28" id="2a28" class="graf graf--p graf-after--figure">To see if everything is connected and working, from the terminal, run <code class="markup--code markup--p-code">npm start</code> and then choose either <code class="markup--code markup--p-code">ios</code> or <code class="markup--code markup--p-code">android</code> simulator to run the React Native app.</p><figure name="22a4" id="22a4" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 756px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 108%;"></div><img class="graf-image" data-image-id="0*rgBoqhlTR3EKuVe1.png" data-width="753" data-height="813" src="https://cdn-images-1.medium.com/max/800/0*rgBoqhlTR3EKuVe1.png"></div></figure><blockquote name="5bcb" id="5bcb" class="graf graf--blockquote graf-after--figure"><em class="markup--em markup--blockquote-em">Note: Android developers make sure that a virtual device (AVD) is already running or a device is connected to your dev machine in order to run the app. If everything runs successfully, you will get the following screen in your simulator or a real device.</em></blockquote><figure name="fdf9" id="fdf9" class="graf graf--figure graf-after--blockquote"><div class="aspectRatioPlaceholder is-locked" style="max-width: 400px; max-height: 866px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 216.5%;"></div><img class="graf-image" data-image-id="0*jhI-omED97ZKVKjq.png" data-width="400" data-height="866" src="https://cdn-images-1.medium.com/max/800/0*jhI-omED97ZKVKjq.png"></div></figure><h3 name="81ba" id="81ba" class="graf graf--h3 graf-after--figure">Building the app</h3><p name="02aa" id="02aa" class="graf graf--p graf-after--h3">In this section, you are going to build the UI part of the React Native and Expo application. The idea behind the demo application for this tutorial is to create a “To-be-read” listing app such that if you read books (like me), you can track which books you want to read this year. In the application, you are going to provide two input fields. One to record the name of the book and the other one is for the author of the book. Open the <code class="markup--code markup--p-code">App.js</code> file and define an initial state.</p><pre name="2d72" id="2d72" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--pre-em">// App.js</em><br>    state = {<br>      title: &#39;&#39;,<br>      author: &#39;&#39;,<br>      books: []<br>    };</code></pre><p name="d1d8" id="d1d8" class="graf graf--p graf-after--pre">The state in the App component contains three properties. The <code class="markup--code markup--p-code">title</code> is equivalent to the title of a book, <code class="markup--code markup--p-code">author</code> for a book&#39;s author name and last one is an array that keeps records of all whole list. Modify the App component further as below.</p><pre name="19d7" id="19d7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--pre-em">// App.js</em><br>    import React from &#39;react&#39;;<br>    import { StyleSheet, Text, TextInput, Button, View } from &#39;react-native&#39;;<br>    export default class App extends React.Component {<br>      state = {<br>        title: &#39;&#39;,<br>        author: &#39;&#39;,<br>        books: []<br>      };<br>      onChangeText = (key, val) =&gt; {<br>        this.setState({ [key]: val });<br>      };<br>      render() {<br>        return (<br>          &lt;View style={styles.container}&gt;<br>            &lt;TextInput<br>              style={styles.input}<br>              value={this.state.title}<br>              onChangeText={val =&gt; this.onChangeText(&#39;title&#39;, val)}<br>              placeholder=&quot;What do you want to read?&quot;<br>            /&gt;<br>            &lt;TextInput<br>              style={styles.input}<br>              value={this.state.author}<br>              onChangeText={val =&gt; this.onChangeText(&#39;author&#39;, val)}<br>              placeholder=&quot;Who wrote it?&quot;<br>            /&gt;<br>            &lt;Button<br>              onPress={() =&gt; alert(&#39;Success!&#39;)}<br>              title=&quot;Add to TBR&quot;<br>              color=&quot;#eeaa55&quot;<br>            /&gt;<br>          &lt;/View&gt;<br>        );<br>      }<br>    }<br>    const styles = StyleSheet.create({<br>      container: {<br>        flex: 1,<br>        backgroundColor: &#39;#fff&#39;,<br>        paddingHorizontal: 10,<br>        paddingTop: 50<br>      },<br>      input: {<br>        height: 50,<br>        borderBottomWidth: 2,<br>        borderBottomColor: &#39;blue&#39;,<br>        marginVertical: 10<br>      }<br>    });</code></pre><p name="ded9" id="ded9" class="graf graf--p graf-after--pre">The above <code class="markup--code markup--p-code">App</code> component is a close version of how the app is going to behave in the future. So far you have both the input fields and a button. Each input field has an <code class="markup--code markup--p-code">onPress</code> method that will trigger the API to update the database later when making connections to the GraphQL API. The <code class="markup--code markup--p-code">Button</code> component above also displays a success alert message when clicked.</p><p name="8e60" id="8e60" class="graf graf--p graf-after--p">On running the command <code class="markup--code markup--p-code">npm start</code>, open the app on the desired simulator. You will get the following result.</p><figure name="4bf9" id="4bf9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 400px; max-height: 866px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 216.5%;"></div><img class="graf-image" data-image-id="0*VLiXtLDg1pJZ3RU4.png" data-width="400" data-height="866" src="https://cdn-images-1.medium.com/max/800/0*VLiXtLDg1pJZ3RU4.png"></div></figure><h3 name="a761" id="a761" class="graf graf--h3 graf-after--figure">Adding a GraphQL API using AppSync</h3><p name="d622" id="d622" class="graf graf--p graf-after--h3">To add a GraphQL API to the current app, we are going to leverage AWS AppAsync. It uses GraphQL, an API query language solely focus on data-driven applications. You don’t have to write and hook a complete backend infrastructure. It offers realtime updates and built-in offline support along with first-class integration with ElasticSearch, DynamoDB, and AWS Lambda.</p><p name="d208" id="d208" class="graf graf--p graf-after--p">From the terminal window, run the below command.</p><pre name="359e" id="359e" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">amplify add api</code></pre><p name="2144" id="2144" class="graf graf--p graf-after--pre">On the running the above command, the CLI tool prompts you whether to initiate a GraphQL API or a REST API. Note that any REST API created using this service will lead to the use of Lambda functions that require Node.js functions to be written. Choose the option GraphQL API here.</p><figure name="05da" id="05da" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 518px; max-height: 75px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 14.499999999999998%;"></div><img class="graf-image" data-image-id="0*CzX9iZToqdxJUetZ.png" data-width="518" data-height="75" src="https://cdn-images-1.medium.com/max/800/0*CzX9iZToqdxJUetZ.png"></div></figure><p name="7115" id="7115" class="graf graf--p graf-after--figure">It will continue to ask you a set of questions. Here is the recommended answer to each question that you need to fill in order to proceed with this tutorial.</p><ul class="postList"><li name="3cb3" id="3cb3" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Provide API name</strong>: tbrlist</li><li name="514a" id="514a" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Choose an authorization type for the API</strong>: API key</li><li name="a293" id="a293" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Do you have an annotated GraphQL schema?</strong> No</li><li name="866e" id="866e" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Do you want a guided schema creation?</strong> Yes</li><li name="7277" id="7277" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">What best describes your project</strong>: Single object with fields (e.g., “Todo” with ID, name, description)</li><li name="6841" id="6841" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Do you want to edit the schema now?</strong> Yes</li></ul><p name="0d54" id="0d54" class="graf graf--p graf-after--li">Answering <strong class="markup--strong markup--p-strong">Yes</strong> to the last question will open the default text editor on your local machine with a new file called <code class="markup--code markup--p-code">schema.graphql</code>. In this file, you can modify the default schema for your GraphQL API object. Since you choose a single object that can have multiple fields, edit the file as follows:</p><pre name="94ee" id="94ee" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">type Book @model {<br>      id: ID!<br>      title: String!<br>      author: String<br>    }</code></pre><p name="3126" id="3126" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">@model</code> is for storing types in Amazon DynamoDB. Yes, behind the scenes, the data passed through the GraphQL API to store will be stored in DynamoDB. Note that this schema represents a single model of how data is going to be saved. Also, you can completely change this schema or tweak a little according to your needs later from the AWS Console. Once you have edited the schema as above, save the file and go back to terminal window and press enter to continue. It will then complete the setup.</p><p name="ca88" id="ca88" class="graf graf--p graf-after--p">This step creates a local configuration for the AppSync API. If you need to modify anything, you can before executing the next command. Once the next command <code class="markup--code markup--p-code">amplify push</code> is executed, it will write all those changes you did in the cloud services in the real time. Now run the command.</p><figure name="03a9" id="03a9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 566px; max-height: 137px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 24.2%;"></div><img class="graf-image" data-image-id="0*YI-Ij0Bt14Qzkmph.png" data-width="566" data-height="137" src="https://cdn-images-1.medium.com/max/800/0*YI-Ij0Bt14Qzkmph.png"></div></figure><p name="17fa" id="17fa" class="graf graf--p graf-after--figure">You will get a prompt, <strong class="markup--strong markup--p-strong">Do you want to generate code for your newly created GraphQL API?</strong> We are going to with the default and press <strong class="markup--strong markup--p-strong">Y</strong> for yes. Once the GraphQL schema compilation is done you will get a success message and a new configuration file in the project’s root called <code class="markup--code markup--p-code">aws-export.js</code>. You are going to use this file to send queries and mutations.</p><p name="0f3c" id="0f3c" class="graf graf--p graf-after--p">To make sure that the API is created, visit <strong class="markup--strong markup--p-strong">AWS Console</strong> and in the AWS services section on the home page, search for AWS AppSync. You will be directed to a page where the GraphQL APIs are stored such as below.</p><figure name="1778" id="1778" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 371px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53%;"></div><img class="graf-image" data-image-id="1*4E6WGbMjv40UWk2iJO5lJg.jpeg" data-width="1314" data-height="696" src="https://cdn-images-1.medium.com/max/800/1*4E6WGbMjv40UWk2iJO5lJg.jpeg"></div></figure><h3 name="bcbd" id="bcbd" class="graf graf--h3 graf-after--figure">Mutating the GraphQL API</h3><p name="9085" id="9085" class="graf graf--p graf-after--h3">In order to proceed, you are now required to install a dependency related to AWS Amplify. Open a terminal window and execute the following command.</p><pre name="784d" id="784d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">npm install --save aws-amplify</code></pre><p name="f7a2" id="f7a2" class="graf graf--p graf-after--pre">This dependency will allow you to make API calls to the GraphQL service. Open up <code class="markup--code markup--p-code">App.js</code> file and let us first configure a little more to be able to communicate with the database API. Add the following just after you have imported everything.</p><pre name="8ebf" id="8ebf" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">import Amplify from &#39;@aws-amplify/core&#39;;<br>    import config from &#39;./aws-exports&#39;;<br>    Amplify.configure(config);</code></pre><p name="6dc7" id="6dc7" class="graf graf--p graf-after--pre">Next, import <code class="markup--code markup--p-code">API</code> and <code class="markup--code markup--p-code">graphqlOperation</code> helpers from <code class="markup--code markup--p-code">@aws-amplify/api</code>. Using both of them will help you execute any query on performing an action, such as fetching books or any mutation such as creating a new record.</p><pre name="af13" id="af13" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">import API, { graphqlOperation } from &#39;@aws-amplify/api&#39;;</code></pre><p name="65a2" id="65a2" class="graf graf--p graf-after--pre">Let us create the first mutation to add a new book. Mutations in GraphQL are similar to modifying data in a REST API using either HTTP <code class="markup--code markup--p-code">POST</code> or <code class="markup--code markup--p-code">PUT</code>.</p><pre name="3356" id="3356" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const AddBook = `<br>    mutation ($title: String! $author: String) {<br>      createBook(input: {<br>        title: $title<br>        author: $author<br>      }) {<br>        id title author<br>      }<br>    }<br>    `;</code></pre><p name="861b" id="861b" class="graf graf--p graf-after--pre">This mutation <code class="markup--code markup--p-code">AddBook</code> take a title and an author field of type String. In the end, it just returns the whole book object along with an <code class="markup--code markup--p-code">id</code> that is automatically created by the GraphQL API in the database. However, this mutation will be useful when it executes. In the next snippet of code, you are going to add a new asynchronous function called <code class="markup--code markup--p-code">addBook</code> just before the render function of the <code class="markup--code markup--p-code">App</code> component.</p><pre name="2de7" id="2de7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">addBook = async () =&gt; {<br>      if (this.state.title === &#39;&#39; || this.state.author === &#39;&#39;) return;<br>      const book = { title: this.state.title, author: this.state.author };<br>      try {<br>        const books = [...this.state.books, book];<br>        this.setState({ books, title: &#39;&#39;, author: &#39;&#39; });<br>        await API.graphql(graphqlOperation(AddBook, book));<br>        console.log(&#39;success&#39;);<br>      } catch (err) {<br>        console.log(&#39;error: &#39;, err);<br>      }<br>    };</code></pre><p name="12bd" id="12bd" class="graf graf--p graf-after--pre">In the above snippet, there is an <code class="markup--code markup--p-code">if</code> statement to check whether there is an empty field or not. If there is one, don’t mutate data to the database and just return in our case for this demo. You can, however, extend this and show an error to the user on the UI. Next, using <code class="markup--code markup--p-code">try/catch</code> syntax, <code class="markup--code markup--p-code">API.graphql</code> is executed to add the record to the database by running the mutation <code class="markup--code markup--p-code">AddBook</code>. Also, add this function to the <code class="markup--code markup--p-code">onPress</code> prop on the <code class="markup--code markup--p-code">Button</code> component.</p><pre name="8083" id="8083" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">&lt;Button onPress={this.addBook} title=&quot;Add to TBR&quot; color=&quot;#eeaa55&quot; /&gt;</code></pre><p name="0db5" id="0db5" class="graf graf--p graf-after--pre">To verify that the data has been stored there are two ways. First, since there is a <code class="markup--code markup--p-code">console.log</code> statement, in the Expo logs generated, on add the book, it should prompt the word <strong class="markup--strong markup--p-strong">success</strong>.</p><figure name="5208" id="5208" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 337px; max-height: 134px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 39.800000000000004%;"></div><img class="graf-image" data-image-id="1*22oJwFsVE7SpL1iAaXhx5g.jpeg" data-width="337" data-height="134" src="https://cdn-images-1.medium.com/max/800/1*22oJwFsVE7SpL1iAaXhx5g.jpeg"></div></figure><p name="0c5b" id="0c5b" class="graf graf--p graf-after--figure">The second way is to visit the API’s data source. Select the API first, then from sidebar menu, select <strong class="markup--strong markup--p-strong">Data Sources</strong> and then click <strong class="markup--strong markup--p-strong">Resource</strong>.</p><figure name="a6aa" id="a6aa" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 257px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.7%;"></div><img class="graf-image" data-image-id="0*H-z9oMeKvkLD2_Ar.png" data-width="1285" data-height="471" src="https://cdn-images-1.medium.com/max/800/0*H-z9oMeKvkLD2_Ar.png"></div></figure><p name="4361" id="4361" class="graf graf--p graf-after--figure">You will now be directed DynamoDB page associated with the API where data table is actually stored as you can see below.</p><figure name="5a96" id="5a96" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 291px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.6%;"></div><img class="graf-image" data-image-id="0*FYQDJqppqROcZBEd.png" data-width="1328" data-height="552" src="https://cdn-images-1.medium.com/max/800/0*FYQDJqppqROcZBEd.png"></div></figure><p name="e4bc" id="e4bc" class="graf graf--p graf-after--figure">Here is the complete <code class="markup--code markup--p-code">App.js</code> code so far.</p><pre name="0b88" id="0b88" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--pre-em">//App.js</em><br>    import React from &#39;react&#39;;<br>    import { StyleSheet, Text, TextInput, Button, View } from &#39;react-native&#39;;<br>    import Amplify from &#39;aws-amplify&#39;;<br>    import config from &#39;./aws-exports&#39;;<br>    Amplify.configure(config);<br>    import { API, graphqlOperation } from &#39;aws-amplify&#39;;<br>    const AddBook = `<br>    mutation ($title: String! $author: String) {<br>      createBook(input: {<br>        title: $title<br>        author: $author<br>      }) {<br>        id title author<br>      }<br>    }<br>    `;<br>    export default class App extends React.Component {<br>      state = {<br>        title: &#39;&#39;,<br>        author: &#39;&#39;,<br>        books: []<br>      };<br>      onChangeText = (key, val) =&gt; {<br>        this.setState({ [key]: val });<br>      };<br>      addBook = async () =&gt; {<br>        if (this.state.title === &#39;&#39; || this.state.author === &#39;&#39;) return;<br>        const book = { title: this.state.title, author: this.state.author };<br>        try {<br>          const books = [...this.state.books, book];<br>          this.setState({ books, title: &#39;&#39;, author: &#39;&#39; });<br>          console.log(&#39;books: &#39;, books);<br>          await API.graphql(graphqlOperation(AddBook, book));<br>          console.log(&#39;success&#39;);<br>        } catch (err) {<br>          console.log(&#39;error: &#39;, err);<br>        }<br>      };<br>      render() {<br>        return (<br>          &lt;View style={styles.container}&gt;<br>            &lt;TextInput<br>              style={styles.input}<br>              value={this.state.title}<br>              onChangeText={val =&gt; this.onChangeText(&#39;title&#39;, val)}<br>              placeholder=&quot;What do you want to read?&quot;<br>            /&gt;<br>            &lt;TextInput<br>              style={styles.input}<br>              value={this.state.author}<br>              onChangeText={val =&gt; this.onChangeText(&#39;author&#39;, val)}<br>              placeholder=&quot;Who wrote it?&quot;<br>            /&gt;<br>            &lt;Button onPress={this.addBook} title=&quot;Add to TBR&quot; color=&quot;#eeaa55&quot; /&gt;<br>          &lt;/View&gt;<br>        );<br>      }<br>    }<br>    const styles = StyleSheet.create({<br>      container: {<br>        flex: 1,<br>        backgroundColor: &#39;#fff&#39;,<br>        paddingHorizontal: 10,<br>        paddingTop: 50<br>      },<br>      input: {<br>        height: 50,<br>        borderBottomWidth: 2,<br>        borderBottomColor: &#39;blue&#39;,<br>        marginVertical: 10<br>      }<br>    });</code></pre><h3 name="5c54" id="5c54" class="graf graf--h3 graf-after--pre">Querying the data from the API</h3><p name="e6a4" id="e6a4" class="graf graf--p graf-after--h3">Now, add a query to fetch the list of books and display them below the input fields in the app’s UI. Open <code class="markup--code markup--p-code">App.js</code> file and add the below snippet just above the existing GraphQL mutation.</p><pre name="351a" id="351a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const Listbooks = `<br>    query {<br>      listBooks {<br>        items {<br>          id title author<br>        }<br>      }<br>    }<br>    `;</code></pre><p name="65f0" id="65f0" class="graf graf--p graf-after--pre">To fetch the list of books from the data source, add a lifecycle method just below where you have initialized the state inside the <code class="markup--code markup--p-code">App</code> component.</p><pre name="6769" id="6769" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">async componentDidMount() {<br>            try {<br>                const books = await API.graphql(graphqlOperation(ListBooks));<br>                console.log(&#39;books: &#39;, books);<br>                this.setState({ books: books.data.listBooks.items });<br>            } catch (err) {<br>                console.log(&#39;error: &#39;, err);<br>            }<br>        }</code></pre><p name="f887" id="f887" class="graf graf--p graf-after--pre">Fetching data using a query is simpler than sending a mutation. Here is the complete code of <code class="markup--code markup--p-code">App.js</code> file with a query and the list books rendered with its own styling after the <code class="markup--code markup--p-code">Button</code> component using JavaScript&#39;s map function.</p><pre name="2d8b" id="2d8b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--pre-em">// App.js</em><br>    import React from &#39;react&#39;;<br>    import { StyleSheet, Text, TextInput, Button, View } from &#39;react-native&#39;;<br>    import Amplify from &#39;aws-amplify&#39;;<br>    import config from &#39;./aws-exports&#39;;<br>    Amplify.configure(config);<br>    import { API, graphqlOperation } from &#39;aws-amplify&#39;;<br>    const ListBooks = `<br>    query {<br>      listBooks {<br>        items {<br>          id title author<br>        }<br>      }<br>    }<br>    `;<br>    const AddBook = `<br>    mutation ($title: String! $author: String) {<br>      createBook(input: {<br>        title: $title<br>        author: $author<br>      }) {<br>        id title author<br>      }<br>    }<br>    `;<br>    export default class App extends React.Component {<br>      state = {<br>        title: &#39;&#39;,<br>        author: &#39;&#39;,<br>        books: []<br>      };<br>      async componentDidMount() {<br>        try {<br>          const books = await API.graphql(graphqlOperation(ListBooks));<br>          console.log(&#39;books: &#39;, books);<br>          this.setState({ books: books.data.listBooks.items });<br>        } catch (err) {<br>          console.log(&#39;error: &#39;, err);<br>        }<br>      }<br>      onChangeText = (key, val) =&gt; {<br>        this.setState({ [key]: val });<br>      };<br>      addBook = async () =&gt; {<br>        if (this.state.title === &#39;&#39; || this.state.author === &#39;&#39;) return;<br>        const book = { title: this.state.title, author: this.state.author };<br>        try {<br>          const books = [...this.state.books, book];<br>          this.setState({ books, title: &#39;&#39;, author: &#39;&#39; });<br>          console.log(&#39;books: &#39;, books);<br>          await API.graphql(graphqlOperation(AddBook, book));<br>          console.log(&#39;success&#39;);<br>        } catch (err) {<br>          console.log(&#39;error: &#39;, err);<br>        }<br>      };<br>      render() {<br>        return (<br>          &lt;View style={styles.container}&gt;<br>            &lt;TextInput<br>              style={styles.input}<br>              value={this.state.title}<br>              onChangeText={val =&gt; this.onChangeText(&#39;title&#39;, val)}<br>              placeholder=&quot;What do you want to read?&quot;<br>            /&gt;<br>            &lt;TextInput<br>              style={styles.input}<br>              value={this.state.author}<br>              onChangeText={val =&gt; this.onChangeText(&#39;author&#39;, val)}<br>              placeholder=&quot;Who wrote it?&quot;<br>            /&gt;<br>            &lt;Button onPress={this.addBook} title=&quot;Add to TBR&quot; color=&quot;#eeaa55&quot; /&gt;<br>            {this.state.books.map((book, index) =&gt; (<br>              &lt;View key={index} style={styles.book}&gt;<br>                &lt;Text style={styles.title}&gt;{book.title}&lt;/Text&gt;<br>                &lt;Text style={styles.author}&gt;{book.author}&lt;/Text&gt;<br>              &lt;/View&gt;<br>            ))}<br>          &lt;/View&gt;<br>        );<br>      }<br>    }<br>    const styles = StyleSheet.create({<br>      container: {<br>        flex: 1,<br>        backgroundColor: &#39;#fff&#39;,<br>        paddingHorizontal: 10,<br>        paddingTop: 50<br>      },<br>      input: {<br>        height: 50,<br>        borderBottomWidth: 2,<br>        borderBottomColor: &#39;blue&#39;,<br>        marginVertical: 10<br>      },<br>      book: {<br>        borderBottomWidth: 1,<br>        borderBottomColor: &#39;#ddd&#39;,<br>        paddingVertical: 10<br>      },<br>      title: { fontSize: 16 },<br>      author: { color: &#39;rgba(0, 0, 0, .5)&#39; }<br>    });</code></pre><p name="c101" id="c101" class="graf graf--p graf-after--pre">Below image is the final result of the application.</p><figure name="7307" id="7307" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 400px; max-height: 866px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 216.5%;"></div><img class="graf-image" data-image-id="1*Ii_aKidZTchXZBWvgnNH8A.jpeg" data-width="400" data-height="866" src="https://cdn-images-1.medium.com/max/800/1*Ii_aKidZTchXZBWvgnNH8A.jpeg"></div></figure><h3 name="2449" id="2449" class="graf graf--h3 graf-after--figure">Conclusion</h3><p name="c66c" id="c66c" class="graf graf--p graf-after--h3 graf--trailing"><em class="markup--em markup--p-em">Congratulations!</em> You have successfully built a cross-platform mobile app by integrating frameworks like React Native and Expo with services AWS AppSync and Amplify. If you want to dig deep, possibilities are endless for the serverless architecture. Refer to the <a href="https://amplify.aws/community/" data-href="https://amplify.aws/community/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">AWS Amplify community page</a> for more examples and use cases.</p></div></div></section>
</section>
</article></body></html>