<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Simple REST API with Deno</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Simple REST API with Deno</h1>
</header>
<section data-field="subtitle" class="p-summary">
After 2 years of its first release, Deno v1.0 is finally here.
</section>
<section data-field="body" class="e-content">
<section name="3393" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7e5f" id="7e5f" class="graf graf--h3 graf--leading graf--title">Simple REST API with¬†Deno</h3><figure name="41a3" id="41a3" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 394px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><img class="graf-image" data-image-id="0*-4LzMw3XjbuoCMf9.jpg" data-width="1280" data-height="720" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*-4LzMw3XjbuoCMf9.jpg"></div></figure><p name="1bed" id="1bed" class="graf graf--p graf-after--figure">After 2 years of its first release, Deno v1.0 is finally here.</p><h3 name="194a" id="194a" class="graf graf--h3 graf-after--p">So, what is Deno¬†anyway?</h3><blockquote name="3483" id="3483" class="graf graf--blockquote graf-after--h3"><em class="markup--em markup--blockquote-em">Deno is a simple, modern and secure runtime for JavaScript and TypeScript that uses V8 and is built in Rust. </em><a href="http://deno.land/" data-href="http://deno.land/" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">Deno‚Äôs official website</em></a></blockquote><p name="fd25" id="fd25" class="graf graf--p graf-after--blockquote">‚Äã Ryan Dahl the original creator of Node.js (the popular server-side JavaScript runtime) announced Deno at JSConf EU 2018 <a href="https://youtu.be/M3BM9TB-8yA" data-href="https://youtu.be/M3BM9TB-8yA" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">on is his talk</a> titled ‚Äú10 Things I Regret About Node.js‚Äù ( From the title you can see where are we heading to ). In another word, if you are familiar with Node.js then Deno is just like that. Except that it‚Äôs improved in many ways, it‚Äôs created from bottom to top to be a better implementation of Node.js.</p><h3 name="d9b0" id="d9b0" class="graf graf--h3 graf-after--p">A simple comparison with¬†Node.js</h3><p name="e4ef" id="e4ef" class="graf graf--p graf-after--h3">Since Deno and Node.js serve the same purpose, it‚Äôs possible to compare the two directly.</p><figure name="da66" id="da66" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 335px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.9%;"></div><img class="graf-image" data-image-id="1*p96Zoj00AwZacUnasPYxVQ.png" data-width="829" data-height="397" src="https://cdn-images-1.medium.com/max/800/1*p96Zoj00AwZacUnasPYxVQ.png"></div></figure><h3 name="7dcf" id="7dcf" class="graf graf--h3 graf-after--figure">A Deno¬†tutorial</h3><p name="0455" id="0455" class="graf graf--p graf-after--h3">Let‚Äôs play a little bit with Deno.</p><h3 name="8b1e" id="8b1e" class="graf graf--h3 graf-after--p">Deno‚Äôs Installation</h3><p name="0c27" id="0c27" class="graf graf--p graf-after--h3">To install Deno just copy and paste this command line in your terminal.</p><pre name="c477" id="c477" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">curl -fsSL https://deno.land/x/install/install.sh | sh</code></pre><p name="5a76" id="5a76" class="graf graf--p graf-after--pre"><em class="markup--em markup--p-em">For more details check </em><a href="https://github.com/denoland/deno_install" data-href="https://github.com/denoland/deno_install" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">Deno‚Äôs official installation guide.</em></a></p><p name="3ac9" id="3ac9" class="graf graf--p graf-after--p">When it‚Äôs done, you will have access to the <code class="markup--code markup--p-code">deno</code> command.</p><p name="5124" id="5124" class="graf graf--p graf-after--p">You can run <code class="markup--code markup--p-code">deno --help</code> to get the list of the options and subcommands provided by Deno, and you can run <code class="markup--code markup--p-code">deno &lt;subcommand&gt; --help</code> to get additional informations specific the subcommand for example: <code class="markup--code markup--p-code">deno run --help</code></p><p name="cfe4" id="cfe4" class="graf graf--p graf-after--p">Now you can run <code class="markup--code markup--p-code">deno</code> or <code class="markup--code markup--p-code">deno repl</code> to open the REPL (Read-Execute-Print-Loop) and start typing some Javascript</p><pre name="ed45" id="ed45" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ deno repl<br>Deno 1.0.0<br>exit using ctrl+d or close()<br>&gt; console.log(&quot;Hello World !&quot;)<br>Hello World !</code></pre><p name="3d8c" id="3d8c" class="graf graf--p graf-after--pre">For the mean time (depending on when you‚Äôre reading this) on <strong class="markup--strong markup--p-strong">May 14 2020</strong> the REPL supports only Javascript:</p><blockquote name="08a9" id="08a9" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">There are many things we can do to improve the REPL without introducing the TS compiler. We should do those things first (e.g. improve inspect, tab completion). Once we‚Äôre on par with Node‚Äôs REPL, we can start looking into how to go beyond that by using typescript. </em><a href="https://github.com/denoland/deno/pull/3760#issuecomment-590472390" data-href="https://github.com/denoland/deno/pull/3760#issuecomment-590472390" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">Ryan Dahl‚Äôs comment on TypeScript support in REPL</em></a></blockquote><h3 name="4e3f" id="4e3f" class="graf graf--h3 graf-after--blockquote">Run a Deno¬†app</h3><p name="9e06" id="9e06" class="graf graf--p graf-after--h3">Use <code class="markup--code markup--p-code">deno run &lt;entry-point&gt;</code> command to launch a Deno app.</p><p name="f37d" id="f37d" class="graf graf--p graf-after--p">The entry point can be¬†<code class="markup--code markup--p-code">.js</code> file,¬†<code class="markup--code markup--p-code">.ts</code> file or even a URL that points to an app entry point and Deno will download, compile and then run it for you:</p><p name="7832" id="7832" class="graf graf--p graf-after--p">for example: <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0">deno run <a href="https://deno.land/std/examples/welcome.ts" data-href="https://deno.land/std/examples/welcome.ts" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://deno.land/std/examples/welcome.ts</a></code></p><pre name="c31a" id="c31a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ deno run https://deno.land/std/examples/welcome.ts<br>Download https://deno.land/std/examples/welcome.ts<br>Compile https://deno.land/std/examples/welcome.ts<br>Welcome to Deno ü¶ï</code></pre><p name="364d" id="364d" class="graf graf--p graf-after--pre">If you run the program again, it gets compiled directly it does not need to be downloaded again, it‚Äôs now cached by Deno:</p><pre name="33c2" id="33c2" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ deno run https://deno.land/std/examples/welcome.ts<br>Compile https://deno.land/std/examples/welcome.ts<br>Welcome to Deno ü¶ï</code></pre><p name="82cd" id="82cd" class="graf graf--p graf-after--pre">You can force a reload of the original source with the <code class="markup--code markup--p-code">--reload</code> flag</p><p name="99c4" id="99c4" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">deno run --reload https://deno.land/std/examples/welcome.ts</code></p><p name="86ef" id="86ef" class="graf graf--p graf-after--p">And If you open the <a href="https://deno.land/std/examples/welcome.ts" data-href="https://deno.land/std/examples/welcome.ts" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://deno.land/std/examples/welcome.ts</a> URL with the browser, you&#39;ll get the page that contains the code and it&#39;s documentation.</p><p name="1cd1" id="1cd1" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">The Deno website provides other examples in the </strong><a href="https://deno.land/std/examples/" data-href="https://deno.land/std/examples/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">examples page</strong></a><strong class="markup--strong markup--p-strong">.</strong></p><h3 name="d6ae" id="d6ae" class="graf graf--h3 graf-after--p">Let&#39;s build a simple REST¬†API</h3><p name="4c13" id="4c13" class="graf graf--p graf-after--h3">We are going to use <a href="https://oakserver.github.io/oak/" data-href="https://oakserver.github.io/oak/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">oak framework</a> and Typescript (you can also use Javascript if you want to)</p><p name="d6eb" id="d6eb" class="graf graf--p graf-after--p">Let&#39;s start by creating an <code class="markup--code markup--p-code">app.ts</code> file that imports the <code class="markup--code markup--p-code">Application</code> from <a href="https://deno.land/x/oak/mod.ts" data-href="https://deno.land/x/oak/mod.ts" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://deno.land/x/oak/mod.ts</a> and the <code class="markup--code markup--p-code">router</code> from &#39;./router.ts&#39;</p><pre name="3f97" id="3f97" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">import { Application } from &#39;https://deno.land/x/oak/mod.ts&#39;<br>import router from &#39;./routes.ts&#39;</code></pre><p name="6914" id="6914" class="graf graf--p graf-after--pre">then we need to set the environment variables <code class="markup--code markup--p-code">HOST</code> and <code class="markup--code markup--p-code">PORT</code></p><pre name="a167" id="a167" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const env = Deno.env.toObject()<br>const HOST = env.HOST || &#39;127.0.0.1&#39;<br>const PORT = env.PORT || 7700</code></pre><p name="2513" id="2513" class="graf graf--p graf-after--pre">Now let&#39;s create the <code class="markup--code markup--p-code">routes.ts</code> file import <code class="markup--code markup--p-code">Router</code> from <a href="https://deno.land/x/oak/mod.ts" data-href="https://deno.land/x/oak/mod.ts" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://deno.land/x/oak/mod.ts</a> and create the routes.</p><pre name="00f9" id="00f9" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">import { Router }from &#39;https://deno.land/x/oak/mod.ts&#39;<br>import { getBooks, getBook, addBook, updateBook, deleteBook } from &#39;./controller.ts&#39;<br><br>const router = new Router()<br>router.get(&#39;/books&#39;, getBooks)<br>      .get(&#39;/books/:isbn&#39;, getBook)<br>      .post(&#39;/books&#39;, addBook)<br>      .put(&#39;/books/:isbn&#39;, updateBook)<br>      .delete(&#39;/books/:isbn&#39;, deleteBook)<br><br>export default router</code></pre><p name="ace4" id="ace4" class="graf graf--p graf-after--pre">NOTE: the functions <code class="markup--code markup--p-code">getBooks</code>, <code class="markup--code markup--p-code">getBook</code>, <code class="markup--code markup--p-code">addBook</code>, <code class="markup--code markup--p-code">updateBook</code> and <code class="markup--code markup--p-code">deleteBook</code> are imported from a local file, it&#39;s just we haven&#39;t created them yet.</p><p name="9d32" id="9d32" class="graf graf--p graf-after--p">After creating the router, let&#39;s finish our <code class="markup--code markup--p-code">app.ts</code> by adding this code to it,</p><pre name="2416" id="2416" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const app = new Application()<br><br>app.use(router.routes())<br>app.use(router.allowedMethods())<br><br>console.log(`Listening on port ${PORT} ...`)<br>await app.listen(`${HOST}:${PORT}`)</code></pre><p name="f742" id="f742" class="graf graf--p graf-after--pre">Now, let&#39;s create the controller.ts file and define an interface for a book <code class="markup--code markup--p-code">IBook</code>, then we declare an initial array of book objects:</p><pre name="4441" id="4441" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">interface IBook {<br>  isbn: string;<br>  author: string;<br>  title: string;<br>}<br><br>let books: Array&lt;IBook&gt; = [{<br>  isbn: &quot;1&quot;,<br>  author: &quot;Robin Wieruch&quot;,<br>  title: &quot;The Road to React&quot;,<br>},{<br>  isbn: &quot;2&quot;,<br>  author: &quot;Kyle Simpson&quot;,<br>  title: &quot;You Don&#39;t Know JS: Scope &amp; Closures&quot;,<br>},{<br>  isbn: &quot;3&quot;,<br>  author: &quot;Andreas A. Antonopoulos&quot;,<br>  title: &quot;Mastering Bitcoin&quot;,<br>}]</code></pre><p name="77ec" id="77ec" class="graf graf--p graf-after--pre">Now let&#39;s implement the functions one by one</p><p name="8724" id="8724" class="graf graf--p graf-after--p">getBooks: returns all the books on the list.</p><pre name="bb28" id="bb28" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const getBooks = ({ response }: { response: any }) =&gt; { <br>  response.body = books <br>}</code></pre><figure name="0e04" id="0e04" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 429px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 61.3%;"></div><img class="graf-image" data-image-id="1*HV1LQ_3U1v66WRLg1wyAGw.png" data-width="1175" data-height="720" src="https://cdn-images-1.medium.com/max/800/1*HV1LQ_3U1v66WRLg1wyAGw.png"></div></figure><p name="7d92" id="7d92" class="graf graf--p graf-after--figure">getBook: returns a single book by its isbn, or error message if not found.</p><pre name="ffad" id="ffad" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const getBook = ({ params, response }: { params: { isbn: string }; response: any }) =&gt; {<br>  const book: IBook | undefined = searchBookByIsbn(params.isbn)<br>  if (book) {<br>    response.status = 200<br>    response.body = book<br>  } else {<br>    response.status = 404<br>    response.body = { message: `Book not found.` }<br>  }   <br>}</code></pre><figure name="8aac" id="8aac" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 333px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.5%;"></div><img class="graf-image" data-image-id="1*SvtviQhrYCS9I-K8_BmH-A.png" data-width="1242" data-height="590" src="https://cdn-images-1.medium.com/max/800/1*SvtviQhrYCS9I-K8_BmH-A.png"></div></figure><p name="8b65" id="8b65" class="graf graf--p graf-after--figure">addBook: add a book to the books list.</p><pre name="9a80" id="9a80" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const addBook = async ({ request, response }: { request: any; response: any }) =&gt; {<br>  const body = await request.body()<br>  const book: IBook = body.value  <br>  books.push(book)<br>  response.body = { message: &#39;OK&#39; }<br>  response.status = 200<br>}</code></pre><figure name="3007" id="3007" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 445px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 63.6%;"></div><img class="graf-image" data-image-id="1*0SJ6y4QvalTedvxWtmv4eg.png" data-width="904" data-height="575" src="https://cdn-images-1.medium.com/max/800/1*0SJ6y4QvalTedvxWtmv4eg.png"></div></figure><figure name="7d21" id="7d21" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 553px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 79%;"></div><img class="graf-image" data-image-id="1*0tzfUjpiSIBL2L0TzDjttQ.png" data-width="979" data-height="773" src="https://cdn-images-1.medium.com/max/800/1*0tzfUjpiSIBL2L0TzDjttQ.png"></div></figure><p name="1661" id="1661" class="graf graf--p graf-after--figure">updateBook: updates a book if exists, return error message if not.</p><pre name="6776" id="6776" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const updateBook = async ({ params, request, response }: { params: { isbn: string }; request: any; response: any }) =&gt; {<br>  let book: IBook | undefined = searchBookByIsbn(params.isbn)<br>  if (book) {<br>    const body = await request.body()<br>    const updateInfos: { author?: string; title?: string } = body.value<br>    book = { ...book, ...updateInfos}<br>    books = [...books.filter(book =&gt; book.isbn !== params.isbn), book]<br>    response.status = 200<br>    response.body = { message: &#39;OK&#39; }<br>  } else {<br>    response.status = 404<br>    response.body = { message: `Book not found` }<br>  }  <br>}</code></pre><figure name="7948" id="7948" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 277px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 39.6%;"></div><img class="graf-image" data-image-id="1*WN-XdMVs9wwgOhqJG7meSA.png" data-width="975" data-height="386" src="https://cdn-images-1.medium.com/max/800/1*WN-XdMVs9wwgOhqJG7meSA.png"></div></figure><figure name="a6fb" id="a6fb" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 537px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.7%;"></div><img class="graf-image" data-image-id="1*8BDpxrjwezhXp9h5bvjPow.png" data-width="876" data-height="672" src="https://cdn-images-1.medium.com/max/800/1*8BDpxrjwezhXp9h5bvjPow.png"></div></figure><p name="bc60" id="bc60" class="graf graf--p graf-after--figure">deleteBook: deletes a book from the books list.</p><pre name="a3c1" id="a3c1" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">const deleteBook = ({ params, response }: { params: { isbn: string }; response: any }) =&gt; {<br>  books = books.filter(book =&gt; book.isbn !== params.isbn)<br>  response.body = { message: &#39;OK&#39; }<br>  response.status = 200<br>}</code></pre><figure name="7c0d" id="7c0d" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 242px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.5%;"></div><img class="graf-image" data-image-id="1*FEova2OdBCkk_MRgqrsKHw.png" data-width="1055" data-height="364" src="https://cdn-images-1.medium.com/max/800/1*FEova2OdBCkk_MRgqrsKHw.png"></div></figure><figure name="3d11" id="3d11" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 622px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 88.9%;"></div><img class="graf-image" data-image-id="1*qTqvwpwGGlSz5MiTxCx-Lg.png" data-width="839" data-height="746" src="https://cdn-images-1.medium.com/max/800/1*qTqvwpwGGlSz5MiTxCx-Lg.png"></div></figure><p name="740a" id="740a" class="graf graf--p graf-after--figure">After adding the functions to the <code class="markup--code markup--p-code">controller.ts</code> we need to export them so we can use them in the <code class="markup--code markup--p-code">router.ts</code> file</p><pre name="7035" id="7035" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">/* return the book if found and undefined if not */<br>const searchBookByIsbn = (isbn: string): ( IBook | undefined ) =&gt; books.filter(book =&gt; book.isbn === isbn )[0]</code></pre><pre name="ffd6" id="ffd6" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">export { getBooks, getBook, addBook, updateBook, deleteBook }</code></pre><p name="cc60" id="cc60" class="graf graf--p graf-after--pre">NOTE: the <code class="markup--code markup--p-code">searchBookByIsbn()</code> it&#39;s just a helper function.</p><p name="3691" id="3691" class="graf graf--p graf-after--p graf--trailing"><strong class="markup--strong markup--p-strong">Here is the </strong><a href="https://github.com/DimuthuKasunWP/deno-rest-api" data-href="https://github.com/DimuthuKasunWP/deno-rest-api" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">source code on GitHub</strong></a><strong class="markup--strong markup--p-strong">.</strong></p></div></div></section>
</section>
</article></body></html>