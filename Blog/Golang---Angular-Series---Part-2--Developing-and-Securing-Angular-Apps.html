<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Golang &amp; Angular Series — Part 2: Developing and Securing Angular Apps</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Golang &amp; Angular Series — Part 2: Developing and Securing Angular Apps</h1>
</header>
<section data-field="subtitle" class="p-summary">
Prerequisites
</section>
<section data-field="body" class="e-content">
<section name="9dfa" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="0df6" id="0df6" class="graf graf--h3 graf--leading graf--title">Golang &amp; Angular Series — Part 2: Developing and Securing Angular Apps</h3><figure name="4296" id="4296" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 367px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 52.5%;"></div><img class="graf-image" data-image-id="1*q-qy7qyzt2rkV65khFZtkQ.png" data-width="875" data-height="459" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*q-qy7qyzt2rkV65khFZtkQ.png"></div></figure><h3 name="ceae" id="ceae" class="graf graf--h3 graf-after--figure">Prerequisites</h3><p name="4a1c" id="4a1c" class="graf graf--p graf-after--h3">For this tutorial, you will need to install Golang, Node.js, and Angular. However, as you will see, the process is quite simple. For starters, you can visit <a href="https://golang.org/doc/install" data-href="https://golang.org/doc/install" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the official installation instructions provided by Golang</a> to install the programming language.</p><p name="74e6" id="74e6" class="graf graf--p graf-after--p">After that, you will need to install Node.js (which comes with NPM). For that, you can follow <a href="https://nodejs.org/en/download/" data-href="https://nodejs.org/en/download/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the instructions described here</a>.</p><p name="77b2" id="77b2" class="graf graf--p graf-after--p">Then, after installing Node.js and NPM, you can issue the following command to install the <a href="https://cli.angular.io/" data-href="https://cli.angular.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Angular CLI</a> tool:</p><pre name="cebc" id="cebc" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">npm install -g @angular/cli</code></pre><blockquote name="6f3f" id="6f3f" class="graf graf--blockquote graf-after--pre"><em class="markup--em markup--blockquote-em">Note: By adding </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">-g</em></code><em class="markup--em markup--blockquote-em"> in the command above, you make NPM install the Angular CLI tool globally. That is, after issuing this command, you will have the </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">ng</em></code><em class="markup--em markup--blockquote-em"> command in all new sessions of your terminal.</em></blockquote><h3 name="9f74" id="9f74" class="graf graf--h3 graf-after--blockquote">Part 1: The Golang Backend Recap</h3><p name="c65b" id="c65b" class="graf graf--p graf-after--h3">In the first part of this series — <a href="https://dimuthukasunwp.github.io/Articles/Golang---Angular-Series---Part-1--Developing-and-Securing-Golang-APIs.html" data-href="https://dimuthukasunwp.github.io/Articles/Golang---Angular-Series---Part-1--Developing-and-Securing-Golang-APIs.html" class="markup--anchor markup--p-anchor" target="_blank">Part 1 — The Backend — Developing and Securing Golang APIs </a>— you have developed a secure backend API with Golang and Gin. If you have followed the previous article, you can jump to the next section. Otherwise, you can still follow this article along. after that, you will have to <a href="https://auth0.com/signup" data-href="https://auth0.com/signup" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">sign up for a free Auth0 account here</a> so you can properly configure and run your backend API.</p><p name="8963" id="8963" class="graf graf--p graf-after--p">After signing up for Auth0, you will have to go to your <a href="https://manage.auth0.com/" data-href="https://manage.auth0.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Auth0 dashboard</a> and proceed as follows:</p><ol class="postList"><li name="0490" id="0490" class="graf graf--li graf-after--p">go to <a href="https://manage.auth0.com/#/apis" data-href="https://manage.auth0.com/#/apis" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">the <em class="markup--em markup--li-em">APIs</em> section</a>;</li><li name="7c32" id="7c32" class="graf graf--li graf-after--li">Click on <em class="markup--em markup--li-em">Create API</em>;</li><li name="87c3" id="87c3" class="graf graf--li graf-after--li">define a <em class="markup--em markup--li-em">Name</em> for your API (e.g., “Golang API”);</li><li name="76de" id="76de" class="graf graf--li graf-after--li">define an <em class="markup--em markup--li-em">Identifier</em> for it (e.g., <code class="markup--code markup--li-code"><a href="https://my-golang-api%29;" data-href="https://my-golang-api);" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://my-golang-api</a></code><a href="https://my-golang-api%29;" data-href="https://my-golang-api);" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">);</a></li><li name="465a" id="465a" class="graf graf--li graf-after--li">and click on the <em class="markup--em markup--li-em">Create</em> button (leave the <em class="markup--em markup--li-em">Signing Algorithm</em> with RS256).</li></ol><figure name="8069" id="8069" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 530px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75.8%;"></div><img class="graf-image" data-image-id="1*HwFkA7rmkzwW4U7IR8tNjA.jpeg" data-width="920" data-height="697" src="https://cdn-images-1.medium.com/max/800/1*HwFkA7rmkzwW4U7IR8tNjA.jpeg"></div></figure><p name="e64e" id="e64e" class="graf graf--p graf-after--figure">Then, to run your API, you will have to issue the following commands:</p><pre name="b16f" id="b16f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># set env variables<br>export AUTH0_API_IDENTIFIER=&lt;YOUR_AUTH0_API&gt;<br>export AUTH0_DOMAIN=&lt;YOUR_AUTH0_TENANT&gt;.auth0.com</code></pre><pre name="e4d8" id="e4d8" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">go run main.go</code></pre><blockquote name="76f3" id="76f3" class="graf graf--blockquote graf-after--pre"><em class="markup--em markup--blockquote-em">Note: You will have to replace </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">&lt;YOUR_AUTH0_API&gt;</em></code><em class="markup--em markup--blockquote-em"> with the identifier you set in your Auth0 API while creating it. Also, you will have to replace </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">&lt;YOUR_AUTH0_TENANT&gt;</em></code><em class="markup--em markup--blockquote-em"> with the subdomain you chose while creating your Auth0 account.</em></blockquote><h3 name="ac4f" id="ac4f" class="graf graf--h3 graf-after--blockquote">Developing a To-Do List Application with Angular</h3><p name="eb53" id="eb53" class="graf graf--p graf-after--h3">Now that you have your backend sorted out, you will proceed with the creation of the front-end app with Angular. This application will consist of a simple home page with a button to redirect users to the to-do list. To access this list, users will have to be authenticated.</p><h3 name="5f58" id="5f58" class="graf graf--h3 graf-after--p">Initializing the Angular Project</h3><p name="e7fc" id="e7fc" class="graf graf--p graf-after--h3">For a starter, you will have to scaffold your new Angular project. You will do this in a new directory called <code class="markup--code markup--p-code">ui</code> inside the project root of your Golang. To create this directory and to scaffold your Angular application, you will use the Angular CLI tool. So, head to the project root of your Golang API and issue the following command:</p><pre name="ede3" id="ede3" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># make sure you are on your backend project root<br>ng new ui</code></pre><p name="635a" id="635a" class="graf graf--p graf-after--pre">This will place a new Angular quick-start project inside the <code class="markup--code markup--p-code">ui</code> directory. Now, you need to go into this new directory and download all your project&#39;s dependencies. To do this, run the following commands:</p><pre name="69e5" id="69e5" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># move into the ui directory<br>cd ui</code></pre><pre name="aab6" id="aab6" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># install all dependencies<br>npm install</code></pre><p name="5470" id="5470" class="graf graf--p graf-after--pre">The last command issued will look at the <code class="markup--code markup--p-code">package.json</code> file and see what are the dependencies defined there so it can download everything.</p><p name="f772" id="f772" class="graf graf--p graf-after--p">Then, another thing you will need to do before start writing your application is to add CDN links to <a href="https://getbootstrap.com/" data-href="https://getbootstrap.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Bootstrap</a> and <a href="https://fontawesome.com/" data-href="https://fontawesome.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Font Awesome</a>. These libraries (or UI frameworks) will help your application look a little bit better without the need of investing too much time on CSS files and icons. So, open the <code class="markup--code markup--p-code">./ui/src/index.html</code> file and replace its contents with this:</p><pre name="4976" id="4976" class="graf graf--pre graf-after--p">&lt;!doctype html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>&lt;head&gt;<br>&lt;meta charset=&quot;utf-8&quot;&gt;<br>&lt;title&gt;Auth0 Golang Example&lt;/title&gt;<br>&lt;base href=&quot;/&quot;&gt;<br>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/x-icon&quot; href=&quot;favicon.ico&quot;&gt;<br>&lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css&quot;&gt;<br>&lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.1.0/css/all.css&quot;&gt;&lt;/head&gt;</pre><pre name="17cf" id="17cf" class="graf graf--pre graf-after--pre">&lt;body&gt;<br>&lt;app-root&gt;&lt;/app-root&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</pre><p name="8936" id="8936" class="graf graf--p graf-after--pre">Then, the last change that you will have to do is to edit the environment files found inside the <code class="markup--code markup--p-code">./ui/src/environments</code> directory. These files will act as global variables for your application and distinguish between whether you are running a local development environment or if you are running in production.</p><p name="f04e" id="f04e" class="graf graf--p graf-after--p">So, first, you will open the <code class="markup--code markup--p-code">environment.prod.ts</code> file and replace its content with this:</p><pre name="5d9e" id="5d9e" class="graf graf--pre graf-after--p">export const environment = {<br>production: true,<br>gateway: &#39;&#39;,<br>callback: &#39;http://localhost:4200/callback&#39;,<br>domain: &#39;&lt;YOUR_AUTH0_TENANT&gt;.auth0.com&#39;,<br>clientId: &#39;&lt;YOUR_AUTH0_APPLICATION_CLIENT_ID&gt;&#39;,<br>audience: &#39;&lt;YOUR_AUTH0_API_IDENTIFIER&gt;&#39;<br>};</pre><p name="77da" id="77da" class="graf graf--p graf-after--pre">Then, as you will spend most of your time developing, you will have to open the <code class="markup--code markup--p-code">environment.ts</code> file (which is considered the config for your development environment by default) and replace its contents with this:</p><pre name="9f96" id="9f96" class="graf graf--pre graf-after--p">export const environment = {<br>production: false,<br>gateway: &#39;http://localhost:3000&#39;,<br>callback: &#39;http://localhost:4200/callback&#39;,<br>domain: &#39;&lt;YOUR_AUTH0_TENANT&gt;.auth0.com&#39;,<br>clientId: &#39;&lt;YOUR_AUTH0_APPLICATION_CLIENT_ID&gt;&#39;,<br>audience: &#39;&lt;YOUR_AUTH0_API_IDENTIFIER&gt;&#39;<br>};</pre><p name="0851" id="0851" class="graf graf--p graf-after--pre">Now, as you already created your Auth0 API in the last part of this series, you can replace <code class="markup--code markup--p-code">&lt;YOUR_AUTH0_API_IDENTIFIER&gt;</code> in both files (for example, you can replace this placeholder with <code class="markup--code markup--p-code">https://my-golang-api</code>). In the next section, you will create an Auth0 Application and then you will be able to replace the other placeholders used above with your own Auth0 values.</p><h3 name="d649" id="d649" class="graf graf--h3 graf-after--p">Creating an Auth0 Application</h3><p name="607d" id="607d" class="graf graf--p graf-after--h3">Now that you have scaffolded your Angular application, you will need to register it at Auth0 so you can properly offer authentication and authorization features to your users. So, head to <a href="https://manage.auth0.com/#/applications" data-href="https://manage.auth0.com/#/applications" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the Applications section of your Auth0 dashboard</a> and hit the <em class="markup--em markup--p-em">Create Application</em> button. When Auth0 shows you the form to create your Application, fill in the following information:</p><ul class="postList"><li name="e3a0" id="e3a0" class="graf graf--li graf-after--p"><em class="markup--em markup--li-em">Name:</em> You can name your application with anything that might help you identify it in the future. For example, “To-Do Angular App”.</li><li name="eda3" id="eda3" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">Application Type:</em> For this one, you will have to choose the <em class="markup--em markup--li-em">Single Page Web Applications</em> option, as this is exactly what you are going to create.</li></ul><figure name="b378" id="b378" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 511px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 73.1%;"></div><img class="graf-image" data-image-id="1*2ZQpfwoKBZzveA5RRaokRw.png" data-width="932" data-height="681" src="https://cdn-images-1.medium.com/max/800/1*2ZQpfwoKBZzveA5RRaokRw.png"></div></figure><p name="3efb" id="3efb" class="graf graf--p graf-after--figure">Then, when you hit the <em class="markup--em markup--p-em">Create</em> button, Auth0 will redirect you to the <em class="markup--em markup--p-em">Quick Start</em> section of your new application. From there, you will have to move to the <em class="markup--em markup--p-em">Settings</em> section so you can finish configuring your application.</p><p name="b0f4" id="b0f4" class="graf graf--p graf-after--p">So, now that you are in the <em class="markup--em markup--p-em">Settings</em> section, search for the <em class="markup--em markup--p-em">Allowed Callback URLs</em> field and insert <code class="markup--code markup--p-code">http://localhost:4200/callback</code> there. You need this configuration because, after the authentication process, Auth0 will only redirect users to the URLs listed in this field (this is a security measure that Auth0 puts in place). After that, you can hit <em class="markup--em markup--p-em">Save</em> to persist the change and leave this page open. You will copy values from it in a moment.</p><p name="8361" id="8361" class="graf graf--p graf-after--p">Now, back into your project, open both the <code class="markup--code markup--p-code">environment.prod.ts</code> and <code class="markup--code markup--p-code">environment.ts</code> files and replace the placeholders as follows:</p><ul class="postList"><li name="37e6" id="37e6" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">&lt;YOUR_AUTH0_TENANT&gt;</code>: In the place of this placeholder, you will have to insert the Auth0 subdomain you chose while creating your account. In the end, you will have something similar to <code class="markup--code markup--li-code">domain: &#39;pungyeon.auth0.com&#39;</code>.</li><li name="ad37" id="ad37" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">&lt;YOUR_AUTH0_APPLICATION_CLIENT_ID&gt;</code>: In the place of this placeholder, you will have to insert the value that Auth0 shows in the <em class="markup--em markup--li-em">Client ID</em> field of your new application. This will be a random string similar to <code class="markup--code markup--li-code">z4Z09pinlP93aqTVaIBkCzzQ9vjZ6eEX</code>.</li></ul><blockquote name="b385" id="b385" class="graf graf--blockquote graf-after--li"><em class="markup--em markup--blockquote-em">Note: You have to make sure you replace both placeholders on both files. Otherwise, you might end up with a buggy sign-in feature.</em></blockquote><h3 name="e88d" id="e88d" class="graf graf--h3 graf-after--blockquote">Creating the Welcome Component</h3><p name="d737" id="d737" class="graf graf--p graf-after--h3">Ok, after configuring the environments of your Angular app, you are ready to start developing it. So, for starters, you will make a new Angular component to show the home page of your app. To do so, you will use Angular CLI one more time:</p><pre name="68e4" id="68e4" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># make sure you are executing this from the ui directory<br>ng g c home</code></pre><blockquote name="02a8" id="02a8" class="graf graf--blockquote graf-after--pre"><em class="markup--em markup--blockquote-em">Note: The command above is the shortened version of </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">ng generate component home</em></code><em class="markup--em markup--blockquote-em">.</em></blockquote><p name="23e7" id="23e7" class="graf graf--p graf-after--blockquote">This command will create a new directory inside<code class="markup--code markup--p-code">app</code>, named <code class="markup--code markup--p-code">home</code>, and it will place four files in it:</p><ul class="postList"><li name="81d7" id="81d7" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">home.component.css</code>: This is the CSS file that will allow you to style your new component.</li><li name="6b61" id="6b61" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">home.component.html</code> - This is the HTML representation of your new component.</li><li name="cfdb" id="cfdb" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">home.component.spec.ts</code> - This is where you would write automated tests for your component.</li><li name="c711" id="c711" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">home.component.ts</code> - This is the main piece of your component.</li></ul><blockquote name="797c" id="797c" class="graf graf--blockquote graf-after--li"><em class="markup--em markup--blockquote-em">Note: The CLI will also automatically add this newly created class to our </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">app.module.ts</em></code><em class="markup--em markup--blockquote-em">, in the </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">@NgModule.declarations</em></code><em class="markup--em markup--blockquote-em"> section.</em></blockquote><p name="f54b" id="f54b" class="graf graf--p graf-after--blockquote">To keep things simple, your home page will be extremely simple. Actually, the only file you will have to change is the <code class="markup--code markup--p-code">home.component.html</code> one. So, open it and replace its content with this:</p><pre name="1c6d" id="1c6d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">&lt;div class=&quot;c-block&quot;&gt;<br>  &lt;h2&gt;Welcome Home!&lt;/h2&gt;<br>  &lt;a class=&quot;btn btn-primary&quot; routerLink=&quot;/todo&quot;&gt;Show Todo List&lt;/a&gt;<br>&lt;/div&gt;</code></pre><p name="b1ef" id="b1ef" class="graf graf--p graf-after--pre">In this case, all you are doing is creating a title and a link that will redirect users to the <code class="markup--code markup--p-code">/todo</code> route. You haven&#39;t determined the routing yet, so that won&#39;t work right now. You will get to that soon.</p><h3 name="d155" id="d155" class="graf graf--h3 graf-after--p">Creating the To-Do Component</h3><p name="198d" id="198d" class="graf graf--p graf-after--h3">After creating the home page, you can focus on creating the component that will provide the to-do list functionality. So, the first step here will be using Angular CLI to create the component:</p><pre name="3453" id="3453" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># make sure you are executing this from the ui directory<br>ng g c todo</code></pre><p name="6369" id="6369" class="graf graf--p graf-after--pre">For this article, you will split the to-do functionality into two things: a component (the one you just created) and a service. The service will be in charge of issuing HTTP requests to your Golang backend API. After creating this service, your component will be able to use it to communicate with your backend so it can display the correct information retrieved by the service.</p><p name="2289" id="2289" class="graf graf--p graf-after--p">So, to create your service, issue the following command:</p><pre name="6f62" id="6f62" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># make sure you are executing this from the ui directory<br>ng g s todo</code></pre><p name="d7b8" id="d7b8" class="graf graf--p graf-after--pre">Then, open the <code class="markup--code markup--p-code">todo.service.ts</code> file and replace its content with this:</p><pre name="fa21" id="fa21" class="graf graf--pre graf-after--p">import { Injectable } from &#39;@angular/core&#39;;<br>import { HttpClient } from &#39;@angular/common/http&#39;;<br>import { environment } from &#39;../environments/environment&#39;;</pre><pre name="a8d6" id="a8d6" class="graf graf--pre graf-after--pre">@Injectable()<br>export class TodoService {</pre><pre name="3a04" id="3a04" class="graf graf--pre graf-after--pre">constructor(private httpClient: HttpClient) {}</pre><pre name="980c" id="980c" class="graf graf--pre graf-after--pre">getTodoList() {<br>return this.httpClient.get(environment.gateway + &#39;/todo&#39;);<br>}</pre><pre name="4b7e" id="4b7e" class="graf graf--pre graf-after--pre">addTodo(todo: Todo) {<br>return this.httpClient.post(environment.gateway + &#39;/todo&#39;, todo);<br>}</pre><pre name="af19" id="af19" class="graf graf--pre graf-after--pre">completeTodo(todo: Todo) {<br>return this.httpClient.put(environment.gateway + &#39;/todo&#39;, todo);<br>}</pre><pre name="926d" id="926d" class="graf graf--pre graf-after--pre">deleteTodo(todo: Todo) {<br>return this.httpClient.delete(environment.gateway + &#39;/todo/&#39; + todo.id);<br>}<br>}</pre><pre name="2657" id="2657" class="graf graf--pre graf-after--pre">export class Todo {<br>id: string;<br>message: string;<br>complete: boolean;</pre><pre name="2644" id="2644" class="graf graf--pre graf-after--pre">}</pre><p name="c798" id="c798" class="graf graf--p graf-after--pre">In the new version of this file, you are stating that you want to <code class="markup--code markup--p-code">export</code> your <code class="markup--code markup--p-code">TodoService</code> class, thereby making it available for other components to use. On the initialization of this class, you are defining that it needs an instance of <code class="markup--code markup--p-code">HttpClient</code>. Then, you are defining four methods to issue HTTP requests to your backend API: <code class="markup--code markup--p-code">getTodoList</code>, <code class="markup--code markup--p-code">addTodo</code>, <code class="markup--code markup--p-code">completeTodo</code>, and <code class="markup--code markup--p-code">deleteTodo</code>.</p><blockquote name="7e4a" id="7e4a" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">Note: </em><a href="https://angular.io/api/core/Injectable" data-href="https://angular.io/api/core/Injectable" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">The </em></a><code class="markup--code markup--blockquote-code"><a href="https://angular.io/api/core/Injectable" data-href="https://angular.io/api/core/Injectable" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">@Injectable()</em></a></code><a href="https://angular.io/api/core/Injectable" data-href="https://angular.io/api/core/Injectable" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em"> decorator ensures this class is available to </em></a><code class="markup--code markup--blockquote-code"><a href="https://angular.io/api/core/Injectable" data-href="https://angular.io/api/core/Injectable" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">Injector</em></a></code><a href="https://angular.io/api/core/Injectable" data-href="https://angular.io/api/core/Injectable" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em"> for creation</em></a><em class="markup--em markup--blockquote-em">.</em></blockquote><p name="7436" id="7436" class="graf graf--p graf-after--blockquote">Also, at the bottom of the file, you are exporting a class called <code class="markup--code markup--p-code">Todo</code>, which is a mirror of the <code class="markup--code markup--p-code">todo</code> structure you used in the backend. You use this class throughout your project to ensure a more accurate description in code of what you are sending and receiving from your backend.</p><p name="fb64" id="fb64" class="graf graf--p graf-after--p">One important thing to notice in this service is that you are using the <code class="markup--code markup--p-code">environment.gateway</code> variable to determine where your HTTP calls are headed. This makes running the same code base in different environments easier.</p><p name="fc43" id="fc43" class="graf graf--p graf-after--p">Now, to take your new service out for a spin, you can open the <code class="markup--code markup--p-code">todo.component.ts</code> file and replace its code with this:</p><pre name="32d5" id="32d5" class="graf graf--pre graf-after--p">import { Component, OnInit } from &#39;@angular/core&#39;;<br>import { TodoService, Todo } from &#39;../todo.service&#39;;</pre><pre name="fcec" id="fcec" class="graf graf--pre graf-after--pre">@Component({<br>selector: &#39;app-todo&#39;,<br>templateUrl: &#39;./todo.component.html&#39;,<br>styleUrls: [&#39;./todo.component.css&#39;]<br>})</pre><pre name="1e5a" id="1e5a" class="graf graf--pre graf-after--pre">export class TodoComponent implements OnInit {</pre><pre name="e46c" id="e46c" class="graf graf--pre graf-after--pre">activeTodos: Todo[];<br>completedTodos: Todo[];<br>todoMessage: string;</pre><pre name="f8f0" id="f8f0" class="graf graf--pre graf-after--pre">constructor(private todoService: TodoService) { }</pre><pre name="f159" id="f159" class="graf graf--pre graf-after--pre">ngOnInit() {<br>this.getAll();<br>}</pre><pre name="8070" id="8070" class="graf graf--pre graf-after--pre">getAll() {<br>this.todoService.getTodoList().subscribe((data: Todo[]) =&gt; {<br>this.activeTodos = data.filter((a) =&gt; !a.complete);<br>this.completedTodos = data.filter((a) =&gt; a.complete);<br>});</pre><pre name="5701" id="5701" class="graf graf--pre graf-after--pre">}<br>addTodo() {</pre><pre name="6bc3" id="6bc3" class="graf graf--pre graf-after--pre">var newTodo : Todo = {<br>message: this.todoMessage,<br>id: &#39;&#39;,<br>complete: false<br>};<br>this.todoService.addTodo(newTodo).subscribe(() =&gt; {<br>this.getAll();<br>this.todoMessage = &#39;&#39;;<br>});</pre><pre name="f18d" id="f18d" class="graf graf--pre graf-after--pre">}</pre><pre name="3061" id="3061" class="graf graf--pre graf-after--pre">completeTodo(todo: Todo) {<br>this.todoService.completeTodo(todo).subscribe(() =&gt; {<br>this.getAll();<br>});</pre><pre name="43bb" id="43bb" class="graf graf--pre graf-after--pre">}</pre><pre name="b601" id="b601" class="graf graf--pre graf-after--pre">deleteTodo(todo: Todo) {<br>this.todoService.deleteTodo(todo).subscribe(() =&gt; {<br>this.getAll();<br>})<br>}<br>}</pre><p name="0a1c" id="0a1c" class="graf graf--p graf-after--pre">Starting from the <code class="markup--code markup--p-code">export class TodoComponent</code>, what you have is three properties that respectively contain your <code class="markup--code markup--p-code">activeTodos</code> list, your <code class="markup--code markup--p-code">completedTodos</code> list, and a <code class="markup--code markup--p-code">todoMessage</code> that will hold data inputted by users. Then, you have the constructor of your component, which is expecting a <code class="markup--code markup--p-code">TodoService</code> instance and that stores it as a private property called <code class="markup--code markup--p-code">todoService</code>.</p><p name="d747" id="d747" class="graf graf--p graf-after--p">Then, the first function of your component, <code class="markup--code markup--p-code">ngOnInit</code>, is a built-in standard of Angular and derives from the interface <code class="markup--code markup--p-code">OnInit</code>. Essentially, the implementation of the <code class="markup--code markup--p-code">OnInit</code> interface will wait for the component to be loaded before executing the <code class="markup--code markup--p-code">ngOnInit</code> function. Then, <code class="markup--code markup--p-code">ngOnInit</code> will retrieve data from your backend with the help of the <code class="markup--code markup--p-code">getAll</code> method. This method, will invoke the <code class="markup--code markup--p-code">todoService.getTodoList</code> function. As you know, this function is an HTTP call to your backend to get all of your todo items.</p><p name="10df" id="10df" class="graf graf--p graf-after--p">The <code class="markup--code markup--p-code">HttpClient</code> in Angular does not return with the response but, rather, with an <code class="markup--code markup--p-code">Observable</code>. Essentially, this is an object that you can &#39;subscribe&#39; so, whenever new data is retrieved, you get notified and can act in some way or another. In this scenario, you are using the observable more like a callback, but it&#39;s strongly recommended reading up on RxJs and Observables. They are super useful in modern JavaScript.</p><p name="6921" id="6921" class="graf graf--p graf-after--p">So, the <code class="markup--code markup--p-code">getAll</code> function subscribes to data from the <code class="markup--code markup--p-code">todoService.getTodoList</code> and, whenever data is received, it assigns all active todos to your <code class="markup--code markup--p-code">activeTodos</code> property (by filtering out any complete items) and do the opposite for the <code class="markup--code markup--p-code">completedTodos</code> property.</p><p name="2a31" id="2a31" class="graf graf--p graf-after--p">The rest of your class methods are corresponding to your <code class="markup--code markup--p-code">TodoService</code>, which in turn was mapped up against your backend API. In other words, you have functions to add, complete, delete, and update your to-do lists.</p><p name="e1e7" id="e1e7" class="graf graf--p graf-after--p">Now that your TypeScript logic is done, you can open the <code class="markup--code markup--p-code">todo.component.html</code> file and replace its contents with this:</p><pre name="38b5" id="38b5" class="graf graf--pre graf-after--p">&lt;h2&gt;Todos&lt;/h2&gt;<br>&lt;table class=&quot;table&quot;&gt;<br>&lt;thead&gt;</pre><pre name="0263" id="0263" class="graf graf--pre graf-after--pre">&lt;tr&gt;<br>&lt;th&gt;ID&lt;/th&gt;<br>&lt;th&gt;Description&lt;/th&gt;<br>&lt;th&gt;Complete&lt;/th&gt;<br>&lt;/tr&gt;</pre><pre name="01b1" id="01b1" class="graf graf--pre graf-after--pre">&lt;/thead&gt;</pre><pre name="2fc2" id="2fc2" class="graf graf--pre graf-after--pre">&lt;tbody&gt;<br>&lt;tr *ngFor=&quot;let todo of activeTodos&quot;&gt;<br>&lt;td&gt;{{todo.id}}&lt;/td&gt;<br>&lt;td&gt;{{todo.message}}&lt;/td&gt;<br>&lt;td&gt;</pre><pre name="4e23" id="4e23" class="graf graf--pre graf-after--pre">&lt;button *ngIf=&quot;!todo.complete&quot; class=&quot;btn btn-secondary&quot; (click)=&quot;completeTodo(todo)&quot;&gt;<br>&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt;<br>&lt;/button&gt;</pre><pre name="9e9b" id="9e9b" class="graf graf--pre graf-after--pre">&lt;button *ngIf=&quot;todo.complete&quot; class=&quot;btn btn-success&quot; disabled&gt;<br>&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt;<br>&lt;/button&gt;</pre><pre name="339b" id="339b" class="graf graf--pre graf-after--pre">&lt;button class=&quot;btn btn-danger&quot; (click)=&quot;deleteTodo(todo)&quot;&gt;<br>&lt;i class=&quot;fa fa-trash&quot;&gt;&lt;/i&gt;<br>&lt;/button&gt;</pre><pre name="90be" id="90be" class="graf graf--pre graf-after--pre">&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;/tbody&gt;<br>&lt;/table&gt;</pre><pre name="236a" id="236a" class="graf graf--pre graf-after--pre">&lt;h3&gt;Completed&lt;/h3&gt;<br>&lt;table class=&quot;table&quot;&gt;<br>&lt;thead&gt;</pre><pre name="2fb7" id="2fb7" class="graf graf--pre graf-after--pre">&lt;tr&gt;<br>&lt;th&gt;ID&lt;/th&gt;<br>&lt;th&gt;Description&lt;/th&gt;<br>&lt;th&gt;Complete&lt;/th&gt;<br>&lt;/tr&gt;<br>&lt;/thead&gt;<br>&lt;tbody&gt;<br>&lt;tr *ngFor=&quot;let todo of completedTodos&quot;&gt;<br>&lt;td&gt;{{todo.id}}&lt;/td&gt;<br>&lt;td&gt;{{todo.message}}&lt;/td&gt;<br>&lt;td&gt;</pre><pre name="96a0" id="96a0" class="graf graf--pre graf-after--pre">&lt;button *ngIf=&quot;!todo.complete&quot; class=&quot;btn btn-secondary&quot; (click)=&quot;completeTodo(todo)&quot;&gt;<br>&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt;<br>&lt;/button&gt;<br>&lt;button *ngIf=&quot;todo.complete&quot; class=&quot;btn btn-success&quot; disabled&gt;<br>&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt;<br>&lt;/button&gt;</pre><pre name="3736" id="3736" class="graf graf--pre graf-after--pre">&lt;button class=&quot;btn btn-danger&quot; (click)=&quot;deleteTodo(todo)&quot;&gt;<br>&lt;i class=&quot;fa fa-trash&quot;&gt;&lt;/i&gt;<br>&lt;/button&gt;<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;/tbody&gt;<br>&lt;/table&gt;</pre><pre name="988f" id="988f" class="graf graf--pre graf-after--pre">&lt;input placeholder=&quot;description...&quot; [(ngModel)]=&quot;todoMessage&quot;&gt;&lt;button class=&quot;btn btn-primary&quot; (click)=&quot;addTodo()&quot;&gt;Add&lt;/button&gt;</pre><p name="f73e" id="f73e" class="graf graf--p graf-after--pre">Basically, your to-do page consists of two tables that use the <code class="markup--code markup--p-code">*ngFor</code> directive to iterate over all the to-do items in <code class="markup--code markup--p-code">activeTodos</code> and <code class="markup--code markup--p-code">completedTodos</code>. These tables contain the <code class="markup--code markup--p-code">id</code> and <code class="markup--code markup--p-code">message</code> of the to-do items, as well as two buttons that allow users to complete and delete items. Also, this page indicates whether the to-do items are completed or not. This happens in the usage of <code class="markup--code markup--p-code">*ngIf</code> directives. If the <code class="markup--code markup--p-code">todo.complete</code> property is false, this page shows an active green button and, if the todo is already completed, it shows a grey disabled button.</p><p name="fbf2" id="fbf2" class="graf graf--p graf-after--p">At the very bottom of this HTML page, you have an input text and a button that, when clicked, triggers the <code class="markup--code markup--p-code">addTodo</code> function. This is what gives your users the possibility of adding new to-do items. The input content is mapped to the <code class="markup--code markup--p-code">todoMessage</code> property via the <code class="markup--code markup--p-code">ngModel</code> directive. This directive works like a two-way data binding, meaning that the property is tied to the input element and the element is tied to the variable. In other words, should one change so will the other?</p><p name="528a" id="528a" class="graf graf--p graf-after--p">Then, to have a component that looks good, you can open the <code class="markup--code markup--p-code">todo.component.css</code> and insert the following code:</p><pre name="945a" id="945a" class="graf graf--pre graf-after--p">button {</pre><pre name="3e73" id="3e73" class="graf graf--pre graf-after--pre">width: auto;<br>margin: 5px;<br>}<br>td {<br>vertical-align: unset;<br>}</pre><p name="dcb2" id="dcb2" class="graf graf--p graf-after--pre">If you were to spin up your project now, none of your hard work would show. That happens because you are not routing your clients anyway and, even if you were, they are not authenticated to get the to-do list from your backend. In the next section, you address both issues.</p><h3 name="b174" id="b174" class="graf graf--h3 graf-after--p">Setting up Routing and Securing Angular with Auth0</h3><p name="9722" id="9722" class="graf graf--p graf-after--h3">For starters, you will have to install <code class="markup--code markup--p-code">auth0-js</code> as a dependency to your project:</p><pre name="f80b" id="f80b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># from the ui directory, run:<br>npm install --save auth0-js</code></pre><p name="1d64" id="1d64" class="graf graf--p graf-after--pre">Then, you will have to create a service to handle the authentication process. To do this, use Angular CLI as follows:</p><pre name="b80c" id="b80c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">ng g s auth</code></pre><p name="2ae6" id="2ae6" class="graf graf--p graf-after--pre">Now that you have your <code class="markup--code markup--p-code">AuthService</code> created, open its file (<code class="markup--code markup--p-code">auth.service.ts</code>) and replace its code with this:</p><pre name="7d3a" id="7d3a" class="graf graf--pre graf-after--p">import { Injectable } from &#39;@angular/core&#39;;<br>import { environment } from &#39;src/environments/environment&#39;;<br>import { Router } from &#39;@angular/router&#39;;<br>import * as auth0 from &#39;auth0-js&#39;;</pre><pre name="1e1c" id="1e1c" class="graf graf--pre graf-after--pre">(window as any).global = window;<br>@Injectable()</pre><pre name="ec09" id="ec09" class="graf graf--pre graf-after--pre">export class AuthService {<br>constructor(public router: Router)  {}<br>access_token: string;<br>id_token: string;<br>expires_at: string;<br>auth0 = new auth0.WebAuth({<br>clientID: environment.clientId,<br>domain: environment.domain,<br>responseType: &#39;token id_token&#39;,<br>audience: environment.audience,<br>redirectUri: environment.callback,<br>scope: &#39;openid&#39;<br>});</pre><pre name="5235" id="5235" class="graf graf--pre graf-after--pre">public login(): void {<br>this.auth0.authorize();</pre><pre name="9ae4" id="9ae4" class="graf graf--pre graf-after--pre">}<br>public handleAuthentication(): void {<br>this.auth0.parseHash((err, authResult) =&gt; {</pre><pre name="125c" id="125c" class="graf graf--pre graf-after--pre">if (err) console.log(err);<br>if (!err &amp;&amp; authResult &amp;&amp; authResult.accessToken &amp;&amp; authResult.idToken) {<br>window.location.hash = &#39;&#39;;<br>this.setSession(authResult);<br>}<br>this.router.navigate([&#39;/home&#39;]);<br>});</pre><pre name="430c" id="430c" class="graf graf--pre graf-after--pre">}<br>private setSession(authResult): void {</pre><pre name="1675" id="1675" class="graf graf--pre graf-after--pre">// Set the time that the Access Token will expire at</pre><pre name="ef13" id="ef13" class="graf graf--pre graf-after--pre">const expiresAt = JSON.stringify((authResult.expiresIn * 1000) + new Date().getTime());</pre><pre name="47f4" id="47f4" class="graf graf--pre graf-after--pre">this.access_token = authResult.accessToken;</pre><pre name="e4bc" id="e4bc" class="graf graf--pre graf-after--pre">this.id_token = authResult.idToken;</pre><pre name="48cd" id="48cd" class="graf graf--pre graf-after--pre">this.expires_at = expiresAt;</pre><pre name="d9dc" id="d9dc" class="graf graf--pre graf-after--pre">}</pre><pre name="2873" id="2873" class="graf graf--pre graf-after--pre">public logout(): void {</pre><pre name="cdc4" id="cdc4" class="graf graf--pre graf-after--pre">this.access_token = null;<br>this.id_token = null;<br>this.expires_at = null;</pre><pre name="0b90" id="0b90" class="graf graf--pre graf-after--pre">// Go back to the home route<br>this.router.navigate([&#39;/&#39;]);</pre><pre name="b1e7" id="b1e7" class="graf graf--pre graf-after--pre">}</pre><pre name="f26b" id="f26b" class="graf graf--pre graf-after--pre">public isAuthenticated(): boolean {</pre><pre name="c681" id="c681" class="graf graf--pre graf-after--pre">// Check whether the current time is past the<br>// Access Token&#39;s expiry time<br>const expiresAt = JSON.parse(this.expires_at || &#39;{}&#39;);<br>return new Date().getTime() &lt; expiresAt;<br>}</pre><pre name="4a1d" id="4a1d" class="graf graf--pre graf-after--pre">public createAuthHeaderValue(): string {<br>return &#39;Bearer &#39; + this.access_token;</pre><pre name="0599" id="0599" class="graf graf--pre graf-after--pre">}</pre><pre name="3daa" id="3daa" class="graf graf--pre graf-after--pre">}</pre><p name="ef66" id="ef66" class="graf graf--p graf-after--pre">As you can see, you have the familiar <code class="markup--code markup--p-code">@Injectable()</code> decorator that makes this service injectable into other components. Then, you define three string properties and a single <code class="markup--code markup--p-code">auth0.WebAuth</code> object. This object is what is used for authenticating against Auth0. As such, you will need to use the information from your environment files with this object to send your users to Auth0 and to inform which application they are trying to get access to.</p><p name="f19e" id="f19e" class="graf graf--p graf-after--p">Your <code class="markup--code markup--p-code">login</code> function is quite simple looking but, essentially, this will initialize the authentication process on Auth0. If the user is authenticated, Auth0 will send them to the specified callback location with a tailing hash on the URL. Then, <code class="markup--code markup--p-code">auth0-js</code> will parse this hash with the <code class="markup--code markup--p-code">parseHash</code> function. If everything goes ok, your code will call the <code class="markup--code markup--p-code">setSession</code> function which will set three properties with the appropriate values: <code class="markup--code markup--p-code">access_token</code>, <code class="markup--code markup--p-code">id_token</code>, and <code class="markup--code markup--p-code">expires_at</code>.</p><p name="5525" id="5525" class="graf graf--p graf-after--p">The <code class="markup--code markup--p-code">lougout</code> function resets all tokens from memory and the <code class="markup--code markup--p-code">isAuthenticated</code> method just returns whether the token has expired or not. You will use this information later while getting an authentication status of your user.</p><p name="034d" id="034d" class="graf graf--p graf-after--p">Lastly, you have the <code class="markup--code markup--p-code">createAuthHeaderValue</code> function, which returns a string in the form of an <code class="markup--code markup--p-code">Authorization</code> bearer header.</p><p name="261c" id="261c" class="graf graf--p graf-after--p">Now you need to create the callback component, which will be done like the other components:</p><pre name="ec26" id="ec26" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># from the ui directory<br>ng g c callback</code></pre><p name="ab60" id="ab60" class="graf graf--p graf-after--pre">After creating it, change the content of the <code class="markup--code markup--p-code">callback.component.ts</code> file with this:</p><pre name="fd3d" id="fd3d" class="graf graf--pre graf-after--p">import { Component, OnInit } from &#39;@angular/core&#39;;<br>import { AuthService } from &#39;../auth.service&#39;;</pre><pre name="2cb3" id="2cb3" class="graf graf--pre graf-after--pre"><br>@Component({<br>selector: &#39;app-callback&#39;,<br>templateUrl: &#39;./callback.component.html&#39;,<br>styleUrls: [&#39;./callback.component.css&#39;]<br>})</pre><pre name="7677" id="7677" class="graf graf--pre graf-after--pre">export class CallbackComponent implements OnInit {<br>constructor(private auth: AuthService) { }</pre><pre name="ce83" id="ce83" class="graf graf--pre graf-after--pre">ngOnInit() {<br>this.auth.handleAuthentication();<br>}</pre><pre name="e8ca" id="e8ca" class="graf graf--pre graf-after--pre">}</pre><p name="2929" id="2929" class="graf graf--p graf-after--pre">All you are doing here is to invoke the <code class="markup--code markup--p-code">handleAuthentication</code> method of your authentication service once the component is initialized. As you learned, this function parses the URL hash and redirects users to the <code class="markup--code markup--p-code">/home</code> route.</p><p name="14fa" id="14fa" class="graf graf--p graf-after--p">Once you have set your authentication session with your callback component, you will need to make sure that all future requests include the token retrieved from Auth0 in the <code class="markup--code markup--p-code">Authorization</code> header. To do this, you will create an Angular interceptor.</p><p name="2e3b" id="2e3b" class="graf graf--p graf-after--p">So, create a new file called <code class="markup--code markup--p-code">token.interceptor.ts</code> under the <code class="markup--code markup--p-code">./src/app/</code> directory and insert the following code into it:</p><pre name="9633" id="9633" class="graf graf--pre graf-after--p">import { Injectable } from &#39;@angular/core&#39;;<br>import { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent } from &#39;@angular/common/http&#39;;<br>import { AuthService } from &#39;./auth.service&#39;;<br>import { Observable } from &#39;rxjs/internal/Observable&#39;;</pre><pre name="147e" id="147e" class="graf graf--pre graf-after--pre">@Injectable()<br>export class TokenInterceptor implements HttpInterceptor {</pre><pre name="8a2b" id="8a2b" class="graf graf--pre graf-after--pre">constructor(public auth: AuthService) {}</pre><pre name="ae5d" id="ae5d" class="graf graf--pre graf-after--pre">intercept(request: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; {<br>request = request.clone({<br>setHeaders: {<br>Authorization: this.auth.createAuthHeaderValue()<br>}<br>});<br>return next.handle(request);<br>}<br>}</pre><p name="c91f" id="c91f" class="graf graf--p graf-after--pre">This interceptor service intercepts (of course) all of the outgoing HTTP requests and add an authentication header if a token is available. To do this, this interceptor implements <code class="markup--code markup--p-code">HttpInterceptor</code>, which has the constraint of needing the <code class="markup--code markup--p-code">intercept</code> function. This function is then invoked upon an HTTP request.</p><p name="a536" id="a536" class="graf graf--p graf-after--p">Much like the middleware in your backend, this will return a <code class="markup--code markup--p-code">next.handle</code>, which basically forwards the modified request to the original destination. The <code class="markup--code markup--p-code">intercept</code> function, in this case, is quite simple. You are cloning the incoming request to add an <code class="markup--code markup--p-code">Authorization</code> header. Remember, if no token is found, nothing is added. Once the request has been altered, this interceptor invokes the <code class="markup--code markup--p-code">next.handle</code> passing the modified request.</p><p name="a1ca" id="a1ca" class="graf graf--p graf-after--p">The reason why you are creating this interceptor is to ensure that all of your requests contain the appropriate <code class="markup--code markup--p-code">Authorization</code> header. Centralizing the header management like this makes it easier in the future. If changes are made to authentication or if new requests are added to the project, no changes are needed.</p><p name="00dc" id="00dc" class="graf graf--p graf-after--p">To include this in your <code class="markup--code markup--p-code">app.module.ts</code> file, you will need to add the following object to the <code class="markup--code markup--p-code">providers</code> array:</p><pre name="c457" id="c457" class="graf graf--pre graf-after--p">// ... other imports ...<br>import {HTTP_INTERCEPTORS} from &#39;@angular/common/http&#39;;<br>import {TokenInterceptor} from &#39;./token.interceptor&#39;;</pre><pre name="eed3" id="eed3" class="graf graf--pre graf-after--pre">@NgModule({<br>// ... declarations and imports ...<br>providers: [{<br>provide: HTTP_INTERCEPTORS,<br>useClass: TokenInterceptor,<br>multi: true<br>}],<br>// ... bootstrap ...<br>})<br>export class AppModule { }</pre><p name="dccd" id="dccd" class="graf graf--p graf-after--pre">Almost there! Now, you need to change your <code class="markup--code markup--p-code">app.component.ts</code> page to include routing and actually define your routes. You can start by creating the routes. So, create a new file called <code class="markup--code markup--p-code">app-routing.module.ts</code> inside <code class="markup--code markup--p-code">./src/app</code> and insert the following code into it:</p><pre name="db08" id="db08" class="graf graf--pre graf-after--p">import { HomeComponent } from &#39;./home/home.component&#39;;<br>import { RouterModule, Routes } from &quot;@angular/router&quot;;<br>import { NgModule } from &#39;@angular/core&#39;;<br>import { AuthGuardService } from &#39;./auth-guard.service&#39;;<br>import { CallbackComponent } from &#39;./callback/callback.component&#39;;<br>import { TodoComponent } from &#39;./todo/todo.component&#39;;</pre><pre name="5bba" id="5bba" class="graf graf--pre graf-after--pre">const routes: Routes = [<br>{ path: &#39;&#39;, redirectTo: &#39;home&#39;, pathMatch: &#39;full&#39; },<br>{ path: &#39;home&#39;, component: HomeComponent },<br>{ path: &#39;todo&#39;, component: TodoComponent,  canActivate: [AuthGuardService] },<br>{ path: &#39;callback&#39;, component: CallbackComponent }<br>];</pre><pre name="ad20" id="ad20" class="graf graf--pre graf-after--pre">@NgModule({<br>imports: [ RouterModule.forRoot(routes) ],<br>exports: [ RouterModule ]<br>})</pre><pre name="bea4" id="bea4" class="graf graf--pre graf-after--pre">export class AppRoutingModule { }</pre><p name="0a6d" id="0a6d" class="graf graf--p graf-after--pre">The only important aspect of this file is your <code class="markup--code markup--p-code">routes</code> constant. This constant defines an array of paths. The root (<code class="markup--code markup--p-code">&#39;&#39;</code>) path will redirect to your <code class="markup--code markup--p-code">HomeComponent</code>, the <code class="markup--code markup--p-code">todo</code> path will redirect to the <code class="markup--code markup--p-code">TodoComponent</code>, and <code class="markup--code markup--p-code">callback</code> to the <code class="markup--code markup--p-code">CallbackComponent</code>. However, as you will notice, the <code class="markup--code markup--p-code">todo</code> path is slightly different in that it is using the <code class="markup--code markup--p-code">canActivate</code> property and using <code class="markup--code markup--p-code">AuthGuardService</code>. Well... you haven&#39;t written the <code class="markup--code markup--p-code">AuthGuardService</code> yet. So, you can do that right away.</p><p name="fb5c" id="fb5c" class="graf graf--p graf-after--p">The <code class="markup--code markup--p-code">canActivate</code> property basically asks a service (which implements <code class="markup--code markup--p-code">CanActivate</code>) for a boolean response of whether or not a user is able to activate this page. To create this service, execute the following command:</p><pre name="44c5" id="44c5" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># from the ui directory<br>ng g s auth-guard</code></pre><p name="c0b6" id="c0b6" class="graf graf--p graf-after--pre">Then, open the <code class="markup--code markup--p-code">auth-guard.service.ts</code> file and replace its code with this:</p><pre name="ab92" id="ab92" class="graf graf--pre graf-after--p">import { CanActivate, Router } from &#39;@angular/router&#39;;<br>import { Injectable } from &#39;@angular/core&#39;;<br>import { AuthService } from &#39;./auth.service&#39;;</pre><pre name="a0db" id="a0db" class="graf graf--pre graf-after--pre"><br>@Injectable()<br>export class AuthGuardService implements CanActivate {<br>constructor(private auth: AuthService, private router: Router) {}<br>canActivate(): boolean {</pre><pre name="391d" id="391d" class="graf graf--pre graf-after--pre">if (this.auth.isAuthenticated()) {<br>return true;<br>}<br>this.auth.login()<br>}<br>}</pre><p name="f84c" id="f84c" class="graf graf--p graf-after--pre">This is actually a really simple service. This service simply calls the <code class="markup--code markup--p-code">AuthService</code> asking whether the current user is authenticated or not. If the user is authenticated, it returns true, forwarding the user to the requested route. If not, it will invoke the <code class="markup--code markup--p-code">auth.login</code> function, which will send your user to the Auth0 login page.</p><p name="44d4" id="44d4" class="graf graf--p graf-after--p">Now, to make sure all components, services, interceptors, and routers are included in your app, open the <code class="markup--code markup--p-code">app.module.ts</code> file and update it as follows:</p><pre name="fcc6" id="fcc6" class="graf graf--pre graf-after--p">import { BrowserModule } from &#39;@angular/platform-browser&#39;;<br>import { NgModule } from &#39;@angular/core&#39;;<br>import { AppRoutingModule } from &#39;./app-routing.module&#39;;<br>import { HttpClientModule, HTTP_INTERCEPTORS } from &#39;@angular/common/http&#39;;<br>import { AppComponent } from &#39;./app.component&#39;;<br>import { HomeComponent } from &#39;./home/home.component&#39;;<br>import { AuthGuardService } from &#39;./auth-guard.service&#39;;<br>import { AuthService } from &#39;./auth.service&#39;;<br>import { CallbackComponent } from &#39;./callback/callback.component&#39;;<br>import { TodoComponent } from &#39;./todo/todo.component&#39;;<br>import { TodoService } from &#39;./todo.service&#39;;<br>import { FormsModule } from &#39;@angular/forms&#39;;<br>import { TokenInterceptor } from &#39;./token.interceptor&#39;;</pre><pre name="c8c7" id="c8c7" class="graf graf--pre graf-after--pre">@NgModule({<br>declarations: [<br>AppComponent,<br>HomeComponent,<br>CallbackComponent,<br>TodoComponent<br>],<br>imports: [<br>AppRoutingModule,<br>BrowserModule,<br>FormsModule,<br>HttpClientModule<br>],<br>providers: [AuthGuardService, AuthService, TodoService, {<br>provide: HTTP_INTERCEPTORS,<br>useClass: TokenInterceptor,<br>multi: true<br>}],</pre><pre name="95ca" id="95ca" class="graf graf--pre graf-after--pre">bootstrap: [AppComponent]<br>})</pre><pre name="154a" id="154a" class="graf graf--pre graf-after--pre">export class AppModule { }</pre><p name="40d1" id="40d1" class="graf graf--p graf-after--pre">For the routing, as you can see, you have imported the <code class="markup--code markup--p-code">AppRoutingModule</code> class. So, now you can finally include this routing to your application, which will be the last part of this tutorial.</p><h3 name="c3d9" id="c3d9" class="graf graf--h3 graf-after--p">Putting it all together</h3><p name="f0ae" id="f0ae" class="graf graf--p graf-after--h3">So, it’s been a long while, but now you are finally going to add routing to your Angular application. Also, you will create a little menu bar for navigation and to allow users to log out. First, you need to edit the <code class="markup--code markup--p-code">app.component.ts</code> file to add <code class="markup--code markup--p-code">AuthService</code> to it:</p><pre name="e72e" id="e72e" class="graf graf--pre graf-after--p">import { Component } from &#39;@angular/core&#39;;<br>import { AuthService } from &#39;./auth.service&#39;;</pre><pre name="ed19" id="ed19" class="graf graf--pre graf-after--pre">@Component({<br>selector: &#39;app-root&#39;,<br>templateUrl: &#39;./app.component.html&#39;,<br>styleUrls: [&#39;./app.component.css&#39;]<br>})</pre><pre name="11d0" id="11d0" class="graf graf--pre graf-after--pre">export class AppComponent {<br>constructor(public auth: AuthService) {}<br>}</pre><p name="5571" id="5571" class="graf graf--p graf-after--pre">Next, you need to edit the <code class="markup--code markup--p-code">app.component.html</code> file and set it with the following code:</p><pre name="e578" id="e578" class="graf graf--pre graf-after--p">&lt;nav class=&quot;navbar navbar-default&quot;&gt;<br>&lt;div class=&quot;container-fluid&quot;&gt;<br>&lt;div class=&quot;navbar-header&quot;&gt;<br>&lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;Auth0 - Angular&lt;/a&gt;</pre><pre name="4408" id="4408" class="graf graf--pre graf-after--pre">&lt;button<br>class=&quot;btn btn-light btn-margin&quot;<br>routerLink=&quot;/&quot;&gt;<br>Home<br>&lt;/button&gt;<br>&lt;button<br>class=&quot;btn btn-light btn-margin&quot;<br>*ngIf=&quot;!auth.isAuthenticated()&quot;<br>(click)=&quot;auth.login()&quot;&gt;<br>Log In<br>&lt;/button&gt;</pre><pre name="a263" id="a263" class="graf graf--pre graf-after--pre">&lt;button<br>class=&quot;btn btn-light btn-margin &quot;<br>*ngIf=&quot;auth.isAuthenticated()&quot;<br>(click)=&quot;auth.logout()&quot;&gt;<br>Log Out<br>&lt;/button&gt;<br>&lt;/div&gt;<br>&lt;/div&gt;<br>&lt;/nav&gt;</pre><pre name="281e" id="281e" class="graf graf--pre graf-after--pre">&lt;div class=&quot;container-fluid&quot;&gt;<br>&lt;div class=&quot;row&quot;&gt;<br>&lt;div class=&quot;col-sm&quot;&gt;<br>&lt;router-outlet&gt;&lt;/router-outlet&gt;<br>&lt;/div&gt;<br>&lt;/div&gt;<br>&lt;/div&gt;</pre><p name="4024" id="4024" class="graf graf--p graf-after--pre">Here, you are creating a new navigation bar including functions from <code class="markup--code markup--p-code">AuthService</code> to allow users to log in and log out. Underneath this navigation bar, you are including the <code class="markup--code markup--p-code">router-outlet</code> component inside a <code class="markup--code markup--p-code">div.container-fluid</code> element (this is part of Bootstrap). The outlet element is what tells Angular to ask to the routing module which page it should load.</p><p name="f484" id="f484" class="graf graf--p graf-after--p">It’s a very common practice to include the navigation bar together with the routing component. This ensures that the menu is present on all of your pages, without having to reload the navigation bar for each individual page.</p><p name="da15" id="da15" class="graf graf--p graf-after--p">The final touch to your Angular project will be adding some style to it. So, open the <code class="markup--code markup--p-code">styles.css</code> file and insert the following CSS rules:</p><pre name="4ebd" id="4ebd" class="graf graf--pre graf-after--p">.c-block {<br>width: 50%;<br>margin-left: 50%;<br>transform: translateX(-50%);<br>text-align: center;<br>}</pre><pre name="af2b" id="af2b" class="graf graf--pre graf-after--pre">button {<br>margin: 5px;<br>border-radius: 5px;<br>width: 200px;<br>}</pre><pre name="f8ec" id="f8ec" class="graf graf--pre graf-after--pre">img {<br>margin: 20px;<br>}<br>h3 {<br>margin-top: 30px;<br>}</pre><p name="dd1c" id="dd1c" class="graf graf--p graf-after--pre">Finally, you are done developing your Angular project! Your to-do list is now ready for prime time. So, to test your Angular app, go to your terminal, and run this:</p><pre name="5417" id="5417" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># from the ui directory<br>ng serve</code></pre><p name="5059" id="5059" class="graf graf--p graf-after--pre">Then, open a new terminal window and go to the project root. There, you will just need to tweak one more configuration. As you backend runs on a different “domain” (<code class="markup--code markup--p-code">http://localhost:3000</code>) then your Angular app (<code class="markup--code markup--p-code">http://localhost:4200</code>) you will have to enable Cross-Origin Resource Sharing (CORS) in your Golang backend API.</p><p name="541b" id="541b" class="graf graf--p graf-after--p">To do this, you will have to update the <code class="markup--code markup--p-code">main.go</code> file as follows:</p><pre name="e4d1" id="e4d1" class="graf graf--pre graf-after--p">// ... package definition, import statements, and var definitions ...<br>func main() {<br>setAuth0Variables()<br>r := gin.Default()<br>r.Use(CORSMiddleware())</pre><pre name="ddb0" id="ddb0" class="graf graf--pre graf-after--pre">// ... the rest of the function ...<br>}<br>// ... setAuth0Variables, authRequired, terminateWithError functions ...</pre><pre name="72d3" id="72d3" class="graf graf--pre graf-after--pre">func CORSMiddleware() gin.HandlerFunc {<br>return func(c *gin.Context) {<br>c.Writer.Header().Set(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)<br>c.Writer.Header().Set(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization, accept, origin, Cache-Control, X-Requested-With&quot;)<br>c.Writer.Header().Set(&quot;Access-Control-Allow-Methods&quot;, &quot;DELETE, GET, OPTIONS, POST, PUT&quot;)</pre><pre name="22c4" id="22c4" class="graf graf--pre graf-after--pre">if c.Request.Method == &quot;OPTIONS&quot; {<br>c.AbortWithStatus(204)<br>return<br>}<br>c.Next()<br>}</pre><pre name="8eae" id="8eae" class="graf graf--pre graf-after--pre">}</pre><p name="332f" id="332f" class="graf graf--p graf-after--pre">From there, execute the following commands:</p><pre name="07b3" id="07b3" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># set env variables<br>export AUTH0_API_IDENTIFIER=&lt;YOUR_AUTH0_API&gt;<br>export AUTH0_DOMAIN=&lt;YOUR_AUTH0_TENANT&gt;.auth0.com</code></pre><pre name="5e78" id="5e78" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">go run main.go</code></pre><blockquote name="f78f" id="f78f" class="graf graf--blockquote graf-after--pre"><em class="markup--em markup--blockquote-em">Note: You have to replace </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">&lt;YOUR_AUTH0_API&gt;</em></code><em class="markup--em markup--blockquote-em"> with the identifier you set in your Auth0 API while creating it. Also, you have to replace </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">&lt;YOUR_AUTH0_TENANT&gt;</em></code><em class="markup--em markup--blockquote-em"> with the subdomain you chose while creating your Auth0 account.</em></blockquote><p name="70f4" id="70f4" class="graf graf--p graf-after--blockquote">Now, if you open <code class="markup--code markup--p-code"><a href="http://localhost:4200/" data-href="http://localhost:4200/" class="markup--anchor markup--p-anchor" target="_blank">http://localhost:4200</a></code> in a web browser, you will see the following screen:</p><figure name="a489" id="a489" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 215px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 30.7%;"></div><img class="graf-image" data-image-id="1*8GOnBYq2N8lqnlWisVMQBQ.png" data-width="910" data-height="279" src="https://cdn-images-1.medium.com/max/800/1*8GOnBYq2N8lqnlWisVMQBQ.png"></div></figure><p name="6794" id="6794" class="graf graf--p graf-after--figure">Then, if you click on <em class="markup--em markup--p-em">Log In</em> or on <em class="markup--em markup--p-em">Show Todo List</em>, your app will redirect you to Auth0 so you can authenticate. After authenticating, Auth0 will redirect you back to your app so you can proceed using it.</p><p name="2fe8" id="2fe8" class="graf graf--p graf-after--p">When properly logged in, you can click on <em class="markup--em markup--p-em">Show Todo List</em> and start using your app.</p><figure name="e4ce" id="e4ce" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 391px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 55.800000000000004%;"></div><img class="graf-image" data-image-id="1*4ax0KYIRSsRT62xNrBb_9w.png" data-width="946" data-height="528" src="https://cdn-images-1.medium.com/max/800/1*4ax0KYIRSsRT62xNrBb_9w.png"></div></figure><h3 name="4c7a" id="4c7a" class="graf graf--h3 graf-after--figure">Conclusion</h3><p name="d98a" id="d98a" class="graf graf--p graf-after--h3">So, you finally made it! The application that you created was pretty simple. Just a to-do list where you can add, delete, and complete some to-do items. However, the framework around your application is quite sound. You have handled authentication via Auth0, creating a very strong starting point for your application, by starting with security in mind.</p><p name="2707" id="2707" class="graf graf--p graf-after--p">Adding features to your application becomes a lot easier once you have established a strong fundament in security. You can add different to-do lists for different users relatively easily without having to worry about how this will affect your application down the road. Using a third-party security solution like Auth0 is also a great advantage because you can rest assured that this solution will keep your application data safe. With a few changes here and there (such as serving our API and static files over HTTPS), you could quite confidently deploy this code to production.</p><p name="c940" id="c940" class="graf graf--p graf-after--p graf--trailing">I hope this series has been helpful and that it has given some insight on how easy it is to implement a full-stack application with Golang and Angular. Feedback and questions are very welcome!</p></div></div></section>
</section>
</article></body></html>